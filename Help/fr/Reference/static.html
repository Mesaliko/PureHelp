<html><head><title>Static</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="5">Static</font></b></p>

<br><b>Syntaxe</b><blockquote><pre><font face="Courier New, Courier, mono" size="2"><b><font color="#006666">Static</font></b>[.&lt;type&gt;] &lt;variable[.&lt;type&gt;]&gt; [= &lt;constant expression&gt;] [, ...]
</font></pre></blockquote>
<b>Description</b><br><blockquote>


<b><font color="#006666">Static</font></b> permet de créer des variables locales persistantes dans une <a href="../reference/procedures.html">procedure</a>. 
Les variables statiques sont prioritaires sur les variables <a href="../reference/global.html">globales</a>, ce qui implique 
qu'une variable globale sera ignorée dans une procédure si une variable statique portant 
le même nom est déjà déclarée. La valeur de la variable statique n'est pas réinitialisée 
à chaque appel de la procédure: c'est donc un bon moyen pour avoir une variable globale 
affectée à une seule procédure. 
<br>
<br>
<b><font color="#006666">Static</font></b> peut aussi être utilisé avec les <a href="../reference/dim.html">tableaux</a>, les <a href="../reference/newlist.html">listes</a> et les 
<a href="../reference/newmap.html">maps</a>. Lors de la déclaration d'un tableau static, ses paramètres doivent être une valeur constante. 

</blockquote><p><b>Exemple:</b> Avec une variable</p><blockquote>


<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">Global</font></b> a
  a = 10
  
  <b><font color="#006666">Procedure</font></b> <font color="#006666">Change</font>()
    <b><font color="#006666">Static</font></b> a
    a+1
    <b><font color="#006666">Debug</font></b> &quot;Dans la Procédure: &quot;+<font color="#006666">Str</font>(a) <font color="#006666">; Affichera 1, 2, 3 car la variable s'incrémente à chaque appel de la procédure.</font>
  <b><font color="#006666">EndProcedure</font></b> 

<font color="#006666">  Change</font>()
<font color="#006666">  Change</font>()
<font color="#006666">  Change</font>()
  <b><font color="#006666">Debug</font></b> a <font color="#006666">; Affichera 10, car une variable 'static' n'affecte pas une variable 'global'.</font>
</font></pre>

</blockquote><p><b>Exemple:</b> Avec un tableau</p><blockquote>


<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">Global</font></b> <b><font color="#006666">Dim</font></b> <font color="#006666">Tableau</font>(2)
<font color="#006666">  Tableau</font>(0) = 10
  
  <b><font color="#006666">Procedure</font></b> <font color="#006666">Change</font>()
    <b><font color="#006666">Static</font></b> <b><font color="#006666">Dim</font></b> <font color="#006666">Tableau</font>(2)
<font color="#006666">    Tableau</font>(0)+1
    <b><font color="#006666">Debug</font></b> &quot;Dans la Procédure: &quot;+<font color="#006666">Str</font>(<font color="#006666">Tableau</font>(0)) <font color="#006666">; Affichera 1, 2, 3 car la valeur du champ du tableau s'incrémente à chaque appel de la procédure.</font>
  <b><font color="#006666">EndProcedure</font></b> 
  
<font color="#006666">  Change</font>()
<font color="#006666">  Change</font>()
<font color="#006666">  Change</font>()
  <b><font color="#006666">Debug</font></b> <font color="#006666">Tableau</font>(0) <font color="#006666">; Affichera 10, car un tableau 'static' n'affecte pas un tableau 'global'.</font>
</font></pre>

</blockquote><p><b>Exemple:</b> Avec plusieurs procedures</p><blockquote>


<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">Procedure</font></b> <font color="#006666">Foo</font>()
    <b><font color="#006666">Static</font></b> x = 100  <font color="#006666">; La déclaration et l'affectation sont effectuées une seule fois, au lancement du programme.</font>
  
    <b><font color="#006666">Debug</font></b> x
    x + 1
  <b><font color="#006666">EndProcedure</font></b>

<font color="#006666">  Foo</font>() <font color="#006666">; Affiche 100</font>
<font color="#006666">  Foo</font>() <font color="#006666">; Affiche 101</font>
<font color="#006666">  Foo</font>() <font color="#006666">; Affiche 102</font>

  <b><font color="#006666">Debug</font></b> &quot;---&quot;

  <b><font color="#006666">Procedure</font></b> <font color="#006666">Bar</font>()
    <b><font color="#006666">Static</font></b> x  <font color="#006666">; La déclaration est effectuée une seule fois, au lancement du programme.  </font>
    x = 100   <font color="#006666">; L'affectation est effectuée à chaque lancement de la Procedure.</font>
  
    <b><font color="#006666">Debug</font></b> x
    x + 1
  <b><font color="#006666">EndProcedure</font></b>

<font color="#006666">  Bar</font>() <font color="#006666">; Affiche 100</font>
<font color="#006666">  Bar</font>() <font color="#006666">; Affiche 100</font>
<font color="#006666">  Bar</font>() <font color="#006666">; Affiche 100</font>

</font></pre>
</blockquote>
</font></body></html>
