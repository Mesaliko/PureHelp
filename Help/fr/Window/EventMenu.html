<html><head><title>EventMenu</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="4">EventMenu()</font></b></p>
<p><b>Syntaxe</b></p><blockquote>
Resultat = <font color="#006666"><b>EventMenu</b></font>()</blockquote>

</blockquote>
<b>Description</b><br><blockquote>

Renvoie le numéro du menu qui a envoyé 
un évènement. 
<br>
<br>
C'est le même évènement qui permet de 
connaître aussi l'icône d'une 
<a href="../toolbar/index.html">barre d'outils</a> 
ou le 
<a href="addkeyboardshortcut.html">raccourci clavier</a> 
qui a été utilisé. 

</blockquote><p><b>Arguments</b></p><blockquote>
Aucun.


</blockquote><p><b>Valeur de retour</b></p><blockquote>

Renvoie le numéro du menu associé à 
l'évènement. 

</blockquote><p><b>Remarques</b></p><blockquote>

Utilisez cette fonction après un 
évènement de type <font color="#924B72">#PB_Event_Menu</font> 
renvoyé par <a href="windowevent.html">WindowEvent()</a> ou 
<a href="waitwindowevent.html">WaitWindowEvent()</a>. 
<br>
<br>
Cette commande permet aussi de détecter 
quel bouton d'une barre d'outil ou quel 
raccourci clavier a été utilisé. 
<br>
<br>
Un évènement sur une barre d'outils est 
similaire à un évènement sur un menu 
(car les barres d'outils sont la plupart 
du temps des racourcis pour des opérations 
disponibles dans les menus). Il est donc 
préférable de prendre les même 
identifiants pour l'élément du menu et 
le bouton de la barre d'outils qui 
représentent la même action, comme ça 
aucun code supplémentaire n'est 
nécessaire pour gérer la barre d'outils. 

</blockquote><p><b>Exemple</b></p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">If</font></b> <font color="#006666">OpenWindow</font>(0, 0, 0, 230, 90, &quot;Exemple de gestion des évènements...&quot;, <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_ScreenCentered</font>)
  
  <font color="#006666">;Raccourcis clavier</font>
<font color="#006666">  AddKeyboardShortcut</font>(0, <font color="#924B72">#PB_Shortcut_Control</font> | <font color="#924B72">#PB_Shortcut_N</font>, 1)
<font color="#006666">  AddKeyboardShortcut</font>(0, <font color="#924B72">#PB_Shortcut_Control</font> | <font color="#924B72">#PB_Shortcut_O</font>, 2)
<font color="#006666">  AddKeyboardShortcut</font>(0, <font color="#924B72">#PB_Shortcut_Control</font> | <font color="#924B72">#PB_Shortcut_S</font>, 3)
  
  <font color="#006666">;Menu</font>
  <b><font color="#006666">If</font></b> <font color="#006666">CreateMenu</font>(0,<font color="#006666"> WindowID</font>(0))
<font color="#006666">    MenuTitle</font>(&quot;Menu&quot;)
<font color="#006666">    MenuItem</font>(1, &quot;Nouveau&quot;+<font color="#006666">Chr</font>(9)+&quot;Ctrl+N&quot;)
<font color="#006666">    MenuItem</font>(2, &quot;Ouvrir&quot;+<font color="#006666">Chr</font>(9)+&quot;Ctrl+O&quot;)
<font color="#006666">    MenuItem</font>(3, &quot;Enregistrer&quot;+<font color="#006666">Chr</font>(9)+&quot;Ctrl+S&quot;)
  <b><font color="#006666">EndIf</font></b>
  
  <font color="#006666">;Barre d'outils</font>
  <b><font color="#006666">If</font></b> <font color="#006666">CreateToolBar</font>(0,<font color="#006666"> WindowID</font>(0))
<font color="#006666">      UsePNGImageDecoder</font>()
      Path$ = <font color="#924B72">#PB_Compiler_Home</font>  + &quot;Examples&quot; + <font color="#924B72">#PS$</font> + &quot;Sources&quot; + <font color="#924B72">#PS$</font> + &quot;Data&quot; + <font color="#924B72">#PS$</font> + &quot;ToolBar&quot; + <font color="#924B72">#PS$</font> + &quot;&quot;
<font color="#006666">      ToolBarImageButton</font>(0,<font color="#006666"> LoadImage</font>(0, Path$ + &quot;New.png&quot;))
<font color="#006666">      ToolBarImageButton</font>(1,<font color="#006666"> LoadImage</font>(1, Path$ + &quot;Open.png&quot;))
<font color="#006666">      ToolBarImageButton</font>(2,<font color="#006666"> LoadImage</font>(2, Path$ + &quot;Save.png&quot;))
  <b><font color="#006666">EndIf</font></b>
  
  <b><font color="#006666">Repeat</font></b>
    Event =<font color="#006666"> WaitWindowEvent</font>()
    
    <b><font color="#006666">Select</font></b> Event
 
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_Menu</font>
        <b><font color="#006666">Select</font></b> <font color="#006666">EventMenu</font>()
          <b><font color="#006666">Case</font></b> 1 : <b><font color="#006666">Debug</font></b> &quot;Menu 'Nouveau' cliqué ou Bouton 'Nouveau' cliqué ou 'CTRL+N' au clavier !&quot;
          <b><font color="#006666">Case</font></b> 2 : <b><font color="#006666">Debug</font></b> &quot;Menu 'Ouvrir' cliqué ou Bouton 'Ouvrir' cliqué ou 'CTRL+O' au clavier !&quot;
          <b><font color="#006666">Case</font></b> 3 : <b><font color="#006666">Debug</font></b> &quot;Menu 'Enregistrer' cliqué ou Bouton 'Enregistrer' cliqué ou 'CTRL+S' au clavier !&quot;
        <b><font color="#006666">EndSelect</font></b>
        
    <b><font color="#006666">EndSelect</font></b>
  <b><font color="#006666">Until</font></b> Event = <font color="#924B72">#PB_Event_CloseWindow</font>
<b><font color="#006666">EndIf</font></b>
</font></pre>

</blockquote><p><b>Voir aussi</b></p><blockquote>

<a href="windowevent.html">WindowEvent()</a>, <a href="waitwindowevent.html">WaitWindowEvent()</a> 

</Blockquote><p><b>OS Supportés </b><Blockquote>Tous</Blockquote></p><center><- <a href=eventgadget.html>EventGadget()</a> - <a href=index.html>Window Index</a> - <a href=eventtimer.html>EventTimer()</a> -><br><br>

</body></html>