<html><head><title>FileSearch.pb</title><meta charset=~"utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<pre><font face="Courier New, Courier, mono" size="2"><font color="#006666">;
</font><font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;
</font><font color="#006666">;   PureBasic - Recursive File Search example file
</font><font color="#006666">;
</font><font color="#006666">;    (c) Fantaisie Software
</font><font color="#006666">;
</font><font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;
</font>
<b><font color="#006666">Procedure</font></b> <font color="#006666">FileSearch</font>(<b><font color="#006666">List</font></b> <font color="#006666">Files</font>.s(), dir.s, mask.s = &quot;&quot;)
  <b><font color="#006666">Protected</font></b> name.s, id
  
  <b><font color="#006666">If</font></b> <font color="#006666">Right</font>(dir, 1) &lt;&gt; <font color="#924B72">#PS$</font>
    dir + <font color="#924B72">#PS$</font>
  <b><font color="#006666">EndIf</font></b>
  
  id =<font color="#006666"> ExamineDirectory</font>(<font color="#924B72">#PB_Any</font>, dir, &quot;&quot;)
  <b><font color="#006666">If</font></b> id
    <b><font color="#006666">While</font></b> <font color="#006666">NextDirectoryEntry</font>(id)
      name =<font color="#006666"> DirectoryEntryName</font>(id)
      <b><font color="#006666">If</font></b> name = &quot;.&quot; <b><font color="#006666">Or</font></b> name = &quot;..&quot;
        <b><font color="#006666">Continue</font></b>
      <b><font color="#006666">EndIf</font></b>
      
      <b><font color="#006666">If</font></b> <font color="#006666">DirectoryEntryType</font>(id) = <font color="#924B72">#PB_DirectoryEntry_Directory</font> <font color="#006666">; if the path is a folder
</font><font color="#006666">        FileSearch</font>(<font color="#006666">Files</font>(), dir + name + <font color="#924B72">#PS$</font>, mask)            <font color="#006666">; recursive call to subfolder
</font>      <b><font color="#006666">ElseIf</font></b> (<b><font color="#006666">Not</font></b> <font color="#006666">Asc</font>(mask) <b><font color="#006666">Or</font></b> <font color="#006666">GetExtensionPart</font>(name) = mask) <b><font color="#006666">And</font></b> <font color="#006666">AddElement</font>(<font color="#006666">Files</font>())
<font color="#006666">        Files</font>() = dir +<font color="#006666"> DirectoryEntryName</font>(id)
      <b><font color="#006666">EndIf</font></b>
    <b><font color="#006666">Wend</font></b>
    
<font color="#006666">    FinishDirectory</font>(id)
  <b><font color="#006666">EndIf</font></b>
<b><font color="#006666">EndProcedure</font></b>

<b><font color="#006666">Define</font></b> <b><font color="#006666">NewList</font></b> <font color="#006666">Files</font>.s()
<font color="#006666">FileSearch</font>(<font color="#006666">Files</font>(),<font color="#006666"> GetTemporaryDirectory</font>(), &quot;txt&quot;) <font color="#006666">; empty string to find all files
</font>
<b><font color="#006666">ForEach</font></b> <font color="#006666">Files</font>()
  <b><font color="#006666">Debug</font></b> <font color="#006666">Files</font>()
<b><font color="#006666">Next</font></b>
</font></pre>
</body></html>
