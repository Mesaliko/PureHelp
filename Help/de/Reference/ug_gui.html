<html><head><title>Einsteiger-Kapitel - Erstellen einer grafischen Benutzeroberfläche (GUI)</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="5">Einsteiger-Kapitel - Erstellen einer grafischen Benutzeroberfläche (GUI)</font></b></p>

In Ergänzung zum <a href="../reference/ug_textoutput.html">Konsolen-Fenster</a> unterstützt PureBasic auch 
die Erstellung grafischer Benutzeroberflächen (GUI). Daher lasst uns das Beispiel mit den 
Datei-Eigenschaften aus den vorhergehenden Artikeln erneut ansehen und es in eine 
GUI-Applikation umwandeln. 
<br>
<br>
Beachten Sie, dass PureBasic bereits einen sehr viel einfacheren Weg bietet, um diese 
besondere Aufgabe zu erledigen - das <a href="../gadget/explorerlistgadget.html">ExplorerListGadget()</a>; aber dieses Beispiel soll 
in das Verwalten von GUI-Elementen einführen, die Verwendung dieses Gadgets wäre 
für dieses Ziel wenig förderlich. 

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; Die Struktur für die Datei-Informationen wie zuvor.</font>
  <b><font color="#006666">Structure</font></b> FILEITEM
    Name.s
    Attributes.i
    Size.q
    DateCreated.i
    DateAccessed.i
    DateModified.i
  <b><font color="#006666">EndStructure</font></b>
  
  <font color="#006666">; Dies ist eine Konstante zum Identifizieren des Fensters.</font>
  <b><font color="#006666">Enumeration</font></b>
    <font color="#924B72">#WindowFiles</font>
  <b><font color="#006666">EndEnumeration</font></b>
  
  <font color="#006666">; Dies ist eine Aufzählung (von Konstanten) zum Identifizieren der Gadgets, welche auf dem Fenster erscheinen.</font>
  <b><font color="#006666">Enumeration</font></b>
    <font color="#924B72">#Folder</font>
    <font color="#924B72">#Files</font>
  <b><font color="#006666">EndEnumeration</font></b>
  
  <font color="#006666">; Jetzt können wir eine Liste von Dateien definieren, indem wir dafür die zuvor spezifizierte Struktur verwenden.</font>
  <b><font color="#006666">NewList</font></b> <font color="#006666">Files</font>.FILEITEM()
  
  <font color="#006666">; Und einige Variablen für weitere Dinge.</font>
  <b><font color="#006666">Define</font></b>.s Access, Attrib, Create, Folder, Modify, Msg, Num, Size
  <b><font color="#006666">Define</font></b>.l Result, Flags
  
  <font color="#006666">; Diese Variablen werden Details von den GUI-Ereignissen empfangen, wie diese im Programm auftreten.</font>
  <b><font color="#006666">Define</font></b>.l Event, EventWindow, EventGadget, EventType, EventMenu
  
  <font color="#006666">; Diese Funktion ermittelt das Benutzer-Verzeichnis des angemeldeten Anwenders.</font>
  Folder =<font color="#006666"> GetHomeDirectory</font>()
  
  <font color="#006666">; Öffnen des Verzeichnisses zum Auflisten all seiner Inhalte.</font>
  Result =<font color="#006666"> ExamineDirectory</font>(0, Folder, &quot;*.*&quot;)
  
  <font color="#006666">; Ist dies ok, beginnen wir das Auflisten der Einträge.</font>
  <b><font color="#006666">If</font></b> Result
    <font color="#006666">; Durchlauf bis NextDirectoryEntry(0) Null zurückgibt - was anzeigt, dass es keine weiteren Einträge gibt.</font>
    <b><font color="#006666">While</font></b> <font color="#006666">NextDirectoryEntry</font>(0)
      <font color="#006666">; Wenn der Verzeichnis-Eintrag eine Datei und kein Ordner ist.</font>
      <b><font color="#006666">If</font></b> <font color="#006666">DirectoryEntryType</font>(0) = <font color="#924B72">#PB_DirectoryEntry_File</font>
        <font color="#006666">; Fügt ein neues Element zur verketteten Liste hinzu.</font>
<font color="#006666">        AddElement</font>(<font color="#006666">Files</font>())
        <font color="#006666">; Und füllt sie mit den Eigenschaften der Datei.</font>
<font color="#006666">        Files</font>()\Name =<font color="#006666"> DirectoryEntryName</font>(0)
<font color="#006666">        Files</font>()\Size =<font color="#006666"> DirectoryEntrySize</font>(0)
<font color="#006666">        Files</font>()\Attributes =<font color="#006666"> DirectoryEntryAttributes</font>(0)
<font color="#006666">        Files</font>()\DateCreated =<font color="#006666"> DirectoryEntryDate</font>(0, <font color="#924B72">#PB_Date_Created</font>)
<font color="#006666">        Files</font>()\DateAccessed =<font color="#006666"> DirectoryEntryDate</font>(0, <font color="#924B72">#PB_Date_Accessed</font>)
<font color="#006666">        Files</font>()\DateModified =<font color="#006666"> DirectoryEntryDate</font>(0, <font color="#924B72">#PB_Date_Modified</font>)
      <b><font color="#006666">EndIf</font></b>
    <b><font color="#006666">Wend</font></b>
    <font color="#006666">; Schließt das Verzeichnis.</font>
<font color="#006666">    FinishDirectory</font>(0)
  <b><font color="#006666">EndIf</font></b>
  
  <font color="#006666">; Sortiert die Liste in alphabetisch aufsteigender Reihenfolge der Dateinamen.</font>
<font color="#006666">  SortStructuredList</font>(<font color="#006666">Files</font>(), <font color="#924B72">#PB_Sort_Ascending</font>,<font color="#006666"> OffsetOf</font>(FILEITEM\Name), <font color="#924B72">#PB_String</font>)
  
  <font color="#006666">; Der interessante Stoff beginnt hier...</font>
  
  <font color="#006666">; Diese Zeile definiert ein Flag für die Fenster-Attribute, indem die gewünschten Attribut-Konstanten mittels 'OR' (hier das '|' Zeichen) miteinander verknüpft werden.</font>
  Flags = <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_SizeGadget</font> | <font color="#924B72">#PB_Window_MinimizeGadget</font> | <font color="#924B72">#PB_Window_MaximizeGadget</font> | <font color="#924B72">#PB_Window_TitleBar</font>
  
  <font color="#006666">; Öffnet ein GUI-Fenster.</font>
<font color="#006666">  OpenWindow</font>(<font color="#924B72">#WindowFiles</font>, 50, 50, 450, 400, &quot;File Properties&quot;, Flags)
  <font color="#006666">; Ein Text-Gadget zum Anzeigen des Verzeichnis-Namens.</font>
<font color="#006666">  TextGadget</font>(<font color="#924B72">#Folder</font>, 5, 40, 440, 25, Folder)
  <font color="#006666">; Ein ListIcon Gadget, welches die Dateinamen und -eigenschaften beinhaltet.</font>
<font color="#006666">  ListIconGadget</font>(<font color="#924B72">#Files</font>, 5, 70, 440, 326, &quot;#&quot;, 35)
  <font color="#006666">; Hinzufügen von Spalten zum ListIconGadget, welche jede Eigenschaft darstellen sollen.</font>
<font color="#006666">  AddGadgetColumn</font>(<font color="#924B72">#Files</font>, 1, &quot;Name&quot;, 200)
<font color="#006666">  AddGadgetColumn</font>(<font color="#924B72">#Files</font>, 2, &quot;Created&quot;, 100)
<font color="#006666">  AddGadgetColumn</font>(<font color="#924B72">#Files</font>, 3, &quot;Accessed&quot;, 100)
<font color="#006666">  AddGadgetColumn</font>(<font color="#924B72">#Files</font>, 4, &quot;Modified&quot;, 100)
<font color="#006666">  AddGadgetColumn</font>(<font color="#924B72">#Files</font>, 5, &quot;Attributes&quot;, 150)
<font color="#006666">  AddGadgetColumn</font>(<font color="#924B72">#Files</font>, 6, &quot;Size&quot;, 100)
  
  <font color="#006666">; Laden der Dateien in die Listenansicht.</font>
  <b><font color="#006666">ForEach</font></b> <font color="#006666">Files</font>()
    <font color="#006666">; Anzeigen der Eintragsnummer und des Dateinamens.</font>
    Num =<font color="#006666"> StrU</font>(<font color="#006666">ListIndex</font>(<font color="#006666">Files</font>()) + 1)
    
    <font color="#006666">; Diese Zeilen konvertieren die drei Datumswerte in eine gebräuchlichere Ansicht.</font>
    Create =<font color="#006666"> FormatDate</font>(&quot;%dd/%mm/%yyyy&quot;,<font color="#006666"> Files</font>()\DateCreated)
    Access =<font color="#006666"> FormatDate</font>(&quot;%dd/%mm/%yyyy&quot;,<font color="#006666"> Files</font>()\DateAccessed)
    Modify =<font color="#006666"> FormatDate</font>(&quot;%dd/%mm/%yyyy&quot;,<font color="#006666"> Files</font>()\DateModified)

    <font color="#006666">; Konvertiert die Dateigröße in einen String - genauso wie vorhin den Index-Wert,</font>
������ <font color="#006666">; lässt aber Platz für die maximale Größe eines Quad-Wertes.</font>
    Size =<font color="#006666"> StrU</font>(<font color="#006666">Files</font>()\Size)
    
    <font color="#006666">; Konvertiert die Attribute vorerst in einen String.</font>
    Attrib =<font color="#006666"> StrU</font>(<font color="#006666">Files</font>()\Attributes)
    
    <font color="#006666">; Erstellt einen String für die gesamte Zeile.</font>
    <font color="#006666">; Das Zeilenvorschub-Zeichen 'Chr(10)' sagt dem Gadget, dass es zur nächsten Spalte springen soll.</font>
    Msg = Num +<font color="#006666"> Chr</font>(10) +<font color="#006666"> Files</font>()\Name +<font color="#006666"> Chr</font>(10) + Create +<font color="#006666"> Chr</font>(10) + Access +<font color="#006666"> Chr</font>(10) + Modify +<font color="#006666"> Chr</font>(10) + Attrib +<font color="#006666"> Chr</font>(10) + Size
    
    <font color="#006666">; Hinzufügen der Zeile zum Listen-Gadget.</font>
<font color="#006666">    AddGadgetItem</font>(<font color="#924B72">#Files</font>, -1, Msg)
  <b><font color="#006666">Next</font></b> <font color="#006666">Files</font>()
  
  <font color="#006666">; Dies ist die Ereignis-Schleife des Fensters.</font>
  <font color="#006666">; Sie wird sich um all die Ereignisse aus der Interaktion mit dem Anwender kümmern, welche wir unterstützen möchten.</font>
  
  <b><font color="#006666">Repeat</font></b>
    <font color="#006666">; Warten bis ein neues Fenster- oder Gadget-Ereignis auftritt.</font>
    Event =<font color="#006666"> WaitWindowEvent</font>()
    <font color="#006666">; In Programmen mit mehr als einem Fenster ermitteln wir, in welchem Fenster das Ereignis auftrat.</font>
    EventWindow =<font color="#006666"> EventWindow</font>()
    <font color="#006666">; Bei welchem Gadget trat das Ereignis auf.</font>
    EventGadget =<font color="#006666"> EventGadget</font>()
    <font color="#006666">; Welche Art von Ereignis trat auf.</font>
    EventType =<font color="#006666"> EventType</font>()
    
    <font color="#006666">; Hier beginnen nun die entsprechenden Aktionen.</font>
    <b><font color="#006666">Select</font></b> Event
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_Gadget</font>
        <font color="#006666">; Ein Gadget-Ereignis ist aufgetreten.</font>
        <b><font color="#006666">If</font></b> EventGadget = <font color="#924B72">#Folder</font>
        <b><font color="#006666">ElseIf</font></b> EventGadget = <font color="#924B72">#Files</font>
        <b><font color="#006666">EndIf</font></b>
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_CloseWindow</font>
        <font color="#006666">; Das Fenster wurde geschlossen.</font>
        <b><font color="#006666">If</font></b> EventWindow = <font color="#924B72">#WindowFiles</font>
<font color="#006666">          CloseWindow</font>(<font color="#924B72">#WindowFiles</font>)
          <b><font color="#006666">Break</font></b>
        <b><font color="#006666">EndIf</font></b>
    <b><font color="#006666">EndSelect</font></b>

    <font color="#006666">; Wir gehen zurück und tuen das gleiche erneut.</font>
    <font color="#006666">; In der Praxis ist diese Schleife nicht unendlich, weil sie durch Anklicken des Schließ-Knopfes vom Fenster gestoppt werden kann.</font>
  <b><font color="#006666">ForEver</font></b>
</font></pre>

An diesem Punkt hat die Applikation bereits einige nützliche Feature. Sie hat jedoch auch noch einige Probleme: <br>
1) Sie können kein Verzeichnis zum Anzeigen auswählen. <br>
2) Sie können die Inhalte der Liste nicht aktualisieren, ohne das Programm zu schließen und neu zu starten. <br>
3) Wenn Sie das Fenster in der Größe verändern, werden die Gadgets nicht entsprechend in der Größe angepasst. <br>
4) Die Spalte mit den Eigenschaften ist immer noch nicht sehr nützlich. <br>
Wir werden uns das Programm später erneut ansehen, um all diese Unzulänglichkeiten zu beheben. 


<p><b>Einsteiger-Kapitel Navigation</b></p><blockquote>

<a href="../reference/ug_textoutput.html">< Vorheriges: Anzeigen von Text-Ausgabe (Konsole)</a> | <a href="../reference/ug_overview.html">Überblick</a> | <a href="../reference/ug_graphics.html">Nächstes: Anzeigen von Grafik-Ausgabe & einfaches Zeichnen ></a> 
</blockquote>
</font></body></html>