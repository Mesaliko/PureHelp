<html><head><title>DragText</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="4">DragText()</font></b></p>
<p><b>Syntaxe</b></p><blockquote>
Resultat = <font color="#006666"><b>DragText</b></font>(Texte$ [, Actions])</blockquote>

<b>Description</b><br><blockquote>

Lance une opération de 'Drag &amp; Drop' 
en utilisant une donnée de type texte. 

</blockquote><p><b>Arguments</b></p><blockquote>
<style type="text/css">
table.parameters { border-spacing: 0px; border-style: none; border-collapse: collapse; }
table.parameters td { border-width: 1px; padding: 6px; border-style: solid; border-color: gray; vertical-align: top; font-family:Arial; font-size:10pt; }
</style>
<table width="90%" class="parameters">
<tr><td width="10%"><i>Texte$</i></td>
<td width="90%"> 
Le texte à transférer. 

</td></tr>
<tr><td><i>Actions (optionnel)</i></td>
<td> 
Si ce paramètre est omis, <font color="#924B72">#PB_Drag_Copy</font> 
sera utilisé comme valeur par défaut. 
<br>
<br>
Peut être une combinaison de: 
<pre><font face="Courier New, Courier, mono" size="2">  <font color="#924B72">#PB_Drag_Copy</font>: Le texte peut être copié
  <font color="#924B72">#PB_Drag_Move</font>: Le texte peut être déplacé
  <font color="#924B72">#PB_Drag_Link</font>: Le texte peut être lié
</font></pre>
<blockquote>

L'utilisateur peut décider de l'action à 
prendre en utilisant les touches Ctrl ou 
Shift. Les actions disponibles dépendent 
aussi du composant sur lequel le texte va 
être déposé. 
(Sous MacOSX, les actions ne sont traitées 
que comme une suggestion. La cible de dépôt 
peut encore choisir une autre action.) 
</blockquote>


</td></tr>
</table>
</blockquote><p><b>Valeur de retour</b></p><blockquote>

Renvoie une des valeurs 'Actions' pour 
indiquer laquelle a été choisie par 
l'utilisateur, ou <font color="#924B72">#PB_Drag_None</font> si le 
'Drag &amp; Drop' a été annulé. 
<br>
<br>
<b>Note:</b> si <font color="#924B72">#PB_Drag_Move</font> est renvoyé, 
le texte déposé ne sera pas automatiquement 
effacé de l'application PureBasic. Il faudra 
le faire en réponse à ce message. 

</blockquote><p><b>Remarques</b></p><blockquote>

Un 'Drag &amp; Drop' peut être 
démarré n'importe quand, mais il faut que le 
bouton gauche de la souris soit appuyé sinon 
l'opération se terminera immédiatement. Le 
moment le plus approprié pour lancer un 
'Drag &amp; Drop' est en réponse à un évènement 
sur un <a href="../gadget/index.html">Gadget</a> avec 
un <a href="../window/eventtype.html">EventType()</a> valant 
<font color="#924B72">#PB_EventType_DragStart</font>. 
<br>
<br>
Sous MacOS X, l'évènement <font color="#924B72">#PB_EventType_DragStart</font> doit être géré à l'aide de <a href="../window/bindevent.html">BindEvent()</a> 
ou de <a href="../gadget/bindgadgetevent.html">BindGadgetEvent()</a>. 

</blockquote><p><b>Exemple</b></p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">Procedure</font></b> <font color="#006666">DragStartHandler</font>()
<font color="#006666">    ExamineDraggedItems</font>()
    <b><font color="#006666">While</font></b> <font color="#006666">NextDraggedItem</font>()
      Texte$ +<font color="#006666"> GetGadgetItemText</font>(0,<font color="#006666"> DraggedItemIndex</font>()) +<font color="#006666"> Chr</font>(10)
    <b><font color="#006666">Wend</font></b>
    
    <b><font color="#006666">Debug</font></b> &quot;Texte en cours de déplacement : &quot; + Texte$
    
<font color="#006666">    DragText</font>(Texte$)
  <b><font color="#006666">EndProcedure</font></b>

  <font color="#006666">; Sélectionnez des fichiers ou des dossiers et faites-les glisser vers une autre application.</font>
  <font color="#006666">;</font>
  <b><font color="#006666">If</font></b> <font color="#006666">OpenWindow</font>(0, 200, 200, 400, 400, &quot;Cliquer-glisser&quot;)
<font color="#006666">    ListViewGadget</font>(0, 10, 10, 380, 380, <font color="#924B72">#PB_ListView_MultiSelect</font>)
<font color="#006666">    AddGadgetItem</font>(0, -1, &quot;Element 1&quot;)
<font color="#006666">    AddGadgetItem</font>(0, -1, &quot;Element 2&quot;)
<font color="#006666">    AddGadgetItem</font>(0, -1, &quot;Element 3&quot;)
    
    <font color="#006666">; BindGadgetEvent() est requis pour gérer l'événement de démarrage par glisser-déposer</font>
<font color="#006666">    BindGadgetEvent</font>(0, @DragStartHandler(), <font color="#924B72">#PB_EventType_DragStart</font>)
    
    <b><font color="#006666">Repeat</font></b>
      Event =<font color="#006666"> WaitWindowEvent</font>()
    <b><font color="#006666">Until</font></b> Event = <font color="#924B72">#PB_Event_CloseWindow</font>
  <b><font color="#006666">EndIf</font></b>
</font></pre>

</blockquote><p><b>Voir aussi</b></p><blockquote>

<a href="dragfiles.html">DragFiles()</a>, <a href="dragimage.html">DragImage()</a>, <a href="dragprivate.html">DragPrivate()</a>, 
<a href="dragosformats.html">DragOSFormats()</a>, <a href="setdragcallback.html">SetDragCallback()</a> 

</Blockquote><p><b>OS Supportés </b><Blockquote>Windows, Linux</Blockquote></p><center><- <a href=dragprivate.html>DragPrivate()</a> - <a href=index.html>DragDrop Index</a> - <a href=draggeditemindex.html>DraggedItemIndex()</a> -><br><br>

</body></html>