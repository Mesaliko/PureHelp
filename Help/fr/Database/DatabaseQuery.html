<html><head><title>DatabaseQuery</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="4">DatabaseQuery()</font></b></p>
<p><b>Syntaxe</b></p><blockquote>
Resultat = <font color="#006666"><b>DatabaseQuery</b></font>(#BaseDeDonnees, Requete$ [, Options])</blockquote>

</blockquote>
<b>Description</b><br><blockquote>

Exécute une requête SQL qui ne modifie 
pas la base de donnée (de type 'SELECT' 
par exemple). 

</blockquote><p><b>Arguments</b></p><blockquote>
<style type="text/css">
table.parameters { border-spacing: 0px; border-style: none; border-collapse: collapse; }
table.parameters td { border-width: 1px; padding: 6px; border-style: solid; border-color: gray; vertical-align: top; font-family:Arial; font-size:10pt; }
</style>
<table width="90%" class="parameters">
<tr><td width="10%"><i>#BaseDeDonnees</i></td>
<td width="90%"> 
La base de données à utiliser. 

</td></tr>
<tr><td><i>Requete$</i></td>
<td> 
La requête SQL à exécuter. 

</td></tr>
<tr><td><i>Options (optionnel)</i></td>
<td> 
Peut être une des valeurs suivantes: 
<pre><font face="Courier New, Courier, mono" size="2">  <font color="#924B72">#PB_Database_StaticCursor</font> : Exécute la requête pour accéder au résultat d'une manière séquentielle. 
                              Il n'est pas possible de revenir en arrière avec <a href="previousdatabaserow.html">PreviousDatabaseRow()</a> ou <a href="firstdatabaserow.html">FirstDatabaseRow()</a> 
                              sur certains pilotes, mais c'est le moyen le plus rapide pour obtenir les données (par défaut).
  <font color="#924B72">#PB_Database_DynamicCursor</font>: Exécute la requête pour accéder au résultat d'une manière aléatoire 
                              en utilisant <a href="previousdatabaserow.html">PreviousDatabaseRow()</a> ou <a href="firstdatabaserow.html">FirstDatabaseRow()</a>.
                              Cela peut être plus lent, voire non pris en charge sur certains pilotes.
</font></pre>

</td></tr>
</table>
</blockquote><p><b>Valeur de retour</b></p><blockquote>

Renvoie une valeur non nulle si la 
requête a réussi, zéro sinon (en raison 
d'une erreur SQL ou une requête mal 
formatée). 

</blockquote><p><b>Remarques</b></p><blockquote>

Pour modifier une base de données, 
utiliser <a href="databaseupdate.html">DatabaseUpdate()</a>. 
<br>
<br>
Si une requête n'a pas abouti, la 
description exacte de l'erreur peut 
être récupérée grâce à <a href="databaseerror.html">DatabaseError()</a>. 
<br>
<br>
Si une requête a abouti alors 
<a href="nextdatabaserow.html">NextDatabaseRow()</a> peut être utilisé pour 
lister les enregistrements renvoyés. 
Cette commande affecte toujours 
<a href="nextdatabaserow.html">NextDatabaseRow()</a> même si aucun 
enregistrement n'est renvoyé par la 
requête. Il est conseillé d'utiliser 
<a href="databaseupdate.html">DatabaseUpdate()</a> quand une requête ne 
renvoie jamais d'enregistrement. 
<br>
<br>
Pour obtenir le nombre de colonnes 
(champs) renvoyé par la requête, utiliser 
<a href="databasecolumns.html">DatabaseColumns()</a>.<br>
Pour exécuter une requête qui ne renvoie 
pas tous les enregistrements (données), 
utiliser <a href="databaseupdate.html">DatabaseUpdate()</a> au lieu de 
<a href="databasequery.html">DatabaseQuery()</a>(). 
<br>
<br>
Une fois que les résultats de la requête 
ne sont plus nécessaires, 
<a href="finishdatabasequery.html">FinishDatabaseQuery()</a> doit être appelée 
pour libérer toutes les ressources de la 
requête. 
<br>
<br>
La requête peut contenir des espaces 
réservés pour les variables de liaison. 
Ces variables doivent être définies avant 
d'appeler <a href="setdatabasestring.html">SetDatabaseString()</a>, 
<a href="setdatabaselong.html">SetDatabaseLong()</a> etc. Après l'exécution 
de la requête, les variables liées sont 
effacées et doivent être définies à nouveau 
pour de futurs appels. La syntaxe de 
spécification des variables liées à SQL 
dépend de la base de données. 
Voir le deuxième exemple ci-dessous. 

</blockquote><p><b>Exemple</b></p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; D'abord, il faudra se connecter à une base de données qui contient une table 'employee'</font>
  <font color="#006666">;</font>
  <b><font color="#006666">If</font></b> <font color="#006666">DatabaseQuery</font>(<font color="#924B72">#BaseDeDonnees</font>, &quot;SELECT * FROM employee&quot;) <font color="#006666">; Recupère tous les enregistrements de la table 'employee'</font>
  
    <b><font color="#006666">While</font></b> <font color="#006666">NextDatabaseRow</font>(<font color="#924B72">#BaseDeDonnees</font>) <font color="#006666">; Enumeration des enregistrements</font>
      <b><font color="#006666">Debug</font></b> <font color="#006666">GetDatabaseString</font>(<font color="#924B72">#BaseDeDonnees</font>, 0) <font color="#006666">; Affichage du contenu du premier champ</font>
    <b><font color="#006666">Wend</font></b>

<font color="#006666">    FinishDatabaseQuery</font>(<font color="#924B72">#BaseDeDonnees</font>)
  <b><font color="#006666">EndIf</font></b>
</font></pre>

</blockquote><p><b>Exemple:</b> Variables liées avec SQLite, MySQL et ODBC</p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; SQLite, MySQL et ODBC partagent la même syntaxe pour les variables de liaison, indiquées par le caractère &quot;?&quot; </font>
  <font color="#006666">;</font>
<font color="#006666">  SetDatabaseString</font>(<font color="#924B72">#Database</font>, 0, &quot;test&quot;)  
  <b><font color="#006666">If</font></b> <font color="#006666">DatabaseQuery</font>(<font color="#924B72">#Database</font>, &quot;SELECT * FROM employee WHERE id=?&quot;)    
    <font color="#006666">; ...</font>
  <b><font color="#006666">EndIf</font></b>
</font></pre>


</blockquote><p><b>Exemple:</b> PostgreSQL</p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; PostgreSQL utilise une autre syntaxe dans la déclaration: $1, $2 ..  pour indiquer le paramètre indéfini</font>
  <font color="#006666">;</font>
<font color="#006666">  SetDatabaseString</font>(<font color="#924B72">#Database</font>, 0, &quot;test&quot;)  
  <b><font color="#006666">If</font></b> <font color="#006666">DatabaseQuery</font>(<font color="#924B72">#Database</font>, &quot;SELECT * FROM employee WHERE id=$1&quot;)    
    <font color="#006666">; ...</font>
  <b><font color="#006666">EndIf</font></b>
</font></pre>

</blockquote><p><b>Voir aussi</b></p><blockquote>

<a href="databaseupdate.html">DatabaseUpdate()</a>, <a href="nextdatabaserow.html">NextDatabaseRow()</a> 
<a href="setdatabasestring.html">SetDatabaseString()</a>, <a href="setdatabaselong.html">SetDatabaseLong()</a>, 
<a href="setdatabasequad.html">SetDatabaseQuad()</a>, <a href="setdatabasefloat.html">SetDatabaseFloat()</a>, 
<a href="setdatabasedouble.html">SetDatabaseDouble()</a>, <a href="setdatabaseblob.html">SetDatabaseBlob()</a>, 
<a href="setdatabasenull.html">SetDatabaseNull()</a> 

</Blockquote><p><b>OS Supportés </b><Blockquote>Tous</Blockquote></p><center><- <a href=databaseid.html>DatabaseID()</a> - <a href=index.html>Database Index</a> - <a href=databaseupdate.html>DatabaseUpdate()</a> -><br><br>

</body></html>