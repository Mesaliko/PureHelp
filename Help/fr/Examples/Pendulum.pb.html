<html><head><title>Pendulum.pb</title><meta charset=~"utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<pre><font face="Courier New, Courier, mono" size="2">
<font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;
</font><font color="#006666">;   PureBasic - Pendulum waves experiment
</font><font color="#006666">;
</font><font color="#006666">;    (c) Fantaisie Software
</font><font color="#006666">;
</font><font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">; Thanks to kelebrindae for this nice code.
</font>

<font color="#006666">InitEngine3D</font>()

<font color="#006666">InitSprite</font>()
<font color="#006666">InitKeyboard</font>()
<font color="#006666">InitMouse</font>()

<font color="#006666">ExamineDesktops</font>():dx=<font color="#006666">DesktopWidth</font>(0)*0.8:dy=<font color="#006666">DesktopHeight</font>(0)*0.8
<font color="#006666">OpenWindow</font>(0, 0,0,<font color="#006666"> DesktopUnscaledX</font>(dx),<font color="#006666">DesktopUnscaledY</font>(dy), &quot; Pendulum waves experiment - [Arrows]   [Esc] : Quit&quot;,<font color="#924B72">#PB_Window_ScreenCentered</font>)
<font color="#006666">OpenWindowedScreen</font>(<font color="#006666">WindowID</font>(0), 0, 0, dx, dy, 0, 0, 0)

<font color="#006666">Add3DArchive</font>(<font color="#924B72">#PB_Compiler_Home</font> + &quot;examples/3d/Data/Main&quot;, <font color="#924B72">#PB_3DArchive_FileSystem</font>)
<font color="#006666">Add3DArchive</font>(<font color="#924B72">#PB_Compiler_Home</font> + &quot;examples/3d/Data/Textures&quot;, <font color="#924B72">#PB_3DArchive_FileSystem</font>)
<font color="#006666">Parse3DScripts</font>()

<font color="#006666">WorldShadows</font>(<font color="#924B72">#PB_Shadow_Additive</font>)

<font color="#006666">; Texture
</font><font color="#006666">LoadTexture</font>(1,&quot;Wood.jpg&quot;)

<font color="#006666">; Materials
</font><font color="#006666">CreateMaterial</font>(1,<font color="#006666"> TextureID</font>(1),$88bbbb)
<font color="#006666">MaterialShininess</font>(1,32,$888888)

<font color="#006666">CreateMaterial</font>(2, 0, $D0B86B)
<font color="#006666">MaterialShininess</font>(2,64,$ffffff)

<font color="#006666">CreateMaterial</font>(3,<font color="#006666"> TextureID</font>(1), $668888)
<font color="#006666">;MaterialShininess(3,64,$ffffff)
</font>
<font color="#006666">; Entities
</font><font color="#006666">;
</font><font color="#006666">CreatePlane</font>(1, 40, 40, 20, 20, 2,4)
sol =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(1),<font color="#006666"> MaterialID</font>(1))

<font color="#006666">CreateCube</font>(2, 1)
support =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(2),<font color="#006666"> MaterialID</font>(3))
<font color="#006666">ScaleEntity</font>(support, 20, 0.3, 0.3)
<font color="#006666">MoveEntity</font>(support, 0, 10, 0, <font color="#924B72">#PB_Absolute</font>)

support2 =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(2),<font color="#006666"> MaterialID</font>(3))
<font color="#006666">ScaleEntity</font>(support2, 0.4, 12, 0.4)
<font color="#006666">RotateEntity</font>(support2, 30, 0, 0)
<font color="#006666">MoveEntity</font>(support2, 10, 5, -3, <font color="#924B72">#PB_Absolute</font>)

support3 =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(2),<font color="#006666"> MaterialID</font>(3))
<font color="#006666">ScaleEntity</font>(support3, 0.4, 12, 0.4)
<font color="#006666">RotateEntity</font>(support3, -30, 0, 0)
<font color="#006666">MoveEntity</font>(support3, 10, 5, 3, <font color="#924B72">#PB_Absolute</font>)

support4 =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(2),<font color="#006666"> MaterialID</font>(3))
<font color="#006666">ScaleEntity</font>(support4, 0.4, 12, 0.4)
<font color="#006666">RotateEntity</font>(support4, 30, 0, 0)
<font color="#006666">MoveEntity</font>(support4,-10,5,-3, <font color="#924B72">#PB_Absolute</font>)

support5 =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(2),<font color="#006666"> MaterialID</font>(3))
<font color="#006666">ScaleEntity</font>(support5, 0.4, 12, 0.4)
<font color="#006666">RotateEntity</font>(support5, -30, 0, 0)
<font color="#006666">MoveEntity</font>(support5, -10, 5, 3, <font color="#924B72">#PB_Absolute</font>)

<font color="#006666">; Pendulums
</font><font color="#924B72">#NBPENDULUM</font> = 16
<b><font color="#006666">Global</font></b> <b><font color="#006666">Dim</font></b> <font color="#006666">sph</font>.i(<font color="#924B72">#NBPENDULUM</font> + 1)
<b><font color="#006666">Global</font></b> position.f, stringLength.f
<font color="#006666">CreateSphere</font>(3, 0.5,16,16)

<b><font color="#006666">For</font></b> i=1 <b><font color="#006666">To</font></b> <font color="#924B72">#NBPENDULUM</font>
  
  stringLength = 980.6 *<font color="#006666"> Pow</font>(15 / ( 2 * <font color="#924B72">#PI</font> * (24 + i) ), 2)
  position = -9.3 + i * 1.10
  
  <font color="#006666">; Create a sphere
</font><font color="#006666">  sph</font>(i) =<font color="#006666"> CreateEntity</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> MeshID</font>(3),<font color="#006666"> MaterialID</font>(2))
<font color="#006666">  MoveEntity</font>(<font color="#006666">sph</font>(i),<font color="#006666"> EntityX</font>(support) + position,<font color="#006666"> EntityY</font>(support) - stringLength,<font color="#006666">EntityZ</font>(support), <font color="#924B72">#PB_Absolute</font>)
<font color="#006666">  CreateEntityBody</font>(<font color="#006666">sph</font>(i), <font color="#924B72">#PB_Entity_SphereBody</font>)
  
  <font color="#006666">; Attach the support and the sphere
</font><font color="#006666">  PointJoint</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> EntityID</font>(<font color="#006666">sph</font>(i)), 0, stringLength, 0,     0, position, 0, 0 )
<font color="#006666">  CreateLine3D</font>(100 + i,<font color="#006666"> EntityX</font>(support) + position,<font color="#006666"> EntityY</font>(support),<font color="#006666"> EntityZ</font>(support), $77FF00,<font color="#006666"> EntityX</font>(<font color="#006666">sph</font>(i)),<font color="#006666"> EntityY</font>(<font color="#006666">sph</font>(i)),<font color="#006666"> EntityZ</font>(<font color="#006666">sph</font>(i)), $77FF00)
  
  <font color="#006666">; Gently push the sphere
</font><font color="#006666">  ApplyEntityImpulse</font>(<font color="#006666">sph</font>(i),0,0,4)
<b><font color="#006666">Next</font></b>

<font color="#006666">; Camera
</font><font color="#006666">CreateCamera</font>(0, 0, 0, 100, 100)
<font color="#006666">MoveCamera</font>(0, 16, 12, 16, <font color="#924B72">#PB_Absolute</font>)
<font color="#006666">CameraLookAt</font>(0, 0, 5, 0)

<font color="#006666">; Light
</font><font color="#006666">AmbientColor</font>($888888)
<font color="#006666">CreateLight</font>(0,$ffffff, -200,200, 000)

<font color="#006666">;- Main loop
</font><b><font color="#006666">Define</font></b>.f KeyX, KeyY,keyz,dist, MouseX, MouseY,dist

<b><font color="#006666">Repeat</font></b>
  <b><font color="#006666">While</font></b> <font color="#006666">WindowEvent</font>():<b><font color="#006666">Wend</font></b>
<font color="#006666">  ExamineMouse</font>()
<font color="#006666">  ExamineKeyboard</font>()
  MouseX = -<font color="#006666">MouseDeltaX</font>() *  0.05
  MouseY = -<font color="#006666">MouseDeltaY</font>() *  0.05
  keyx=(-<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Left</font>))+<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Right</font>)))*0.2
  keyz=(-<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Down</font>))+<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Up</font>   )))*0.2+<font color="#006666">MouseWheel</font>():dist+(keyz-dist)*0.1
<font color="#006666">  RotateCamera</font>(0, MouseY, MouseX, 0, <font color="#924B72">#PB_Relative</font>)
<font color="#006666">  MoveCamera  </font>(0, KeyX, keyy, -dist)  
  
  <font color="#006666">; Redraw the line3D to  figure the prendulums' strings
</font>  <b><font color="#006666">For</font></b> i=1 <b><font color="#006666">To</font></b> <font color="#924B72">#NBPENDULUM</font>
    position = -9.3 + i * 1.10
<font color="#006666">    CreateLine3D</font>(100 + i,<font color="#006666"> EntityX</font>(support) + position,<font color="#006666"> EntityY</font>(support),<font color="#006666"> EntityZ</font>(support), $77FF00,<font color="#006666"> EntityX</font>(<font color="#006666">sph</font>(i)),<font color="#006666"> EntityY</font>(<font color="#006666">sph</font>(i)),<font color="#006666"> EntityZ</font>(<font color="#006666">sph</font>(i)), $77FF00)
  <b><font color="#006666">Next</font></b> i
  
<font color="#006666">  RenderWorld</font>()
<font color="#006666">  FlipBuffers</font>()
<b><font color="#006666">Until</font></b> <font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Escape</font>) <b><font color="#006666">Or</font></b> Quit = 1</font></pre>
</body></html>
