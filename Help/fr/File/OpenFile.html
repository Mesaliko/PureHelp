<html><head><title>OpenFile</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="4">OpenFile()</font></b></p>
<p><b>Syntaxe</b></p><blockquote>
Resultat = <font color="#006666"><b>OpenFile</b></font>(#Fichier, NomFichier$ [, Options]) </blockquote>

</blockquote>
<b>Description</b><br><blockquote>

Ouvre un fichier en lecture et en écriture 
ou le crée s'il n'existe pas. 

</blockquote><p><b>Arguments</b></p><blockquote>
<style type="text/css">
table.parameters { border-spacing: 0px; border-style: none; border-collapse: collapse; }
table.parameters td { border-width: 1px; padding: 6px; border-style: solid; border-color: gray; vertical-align: top; font-family:Arial; font-size:10pt; }
</style>
<table width="90%" class="parameters">
<tr><td width="10%"><i>#Fichier</i></td>
<td width="90%"> 
Le fichier à utiliser. 
<br>
<br>
<a href="../reference/purebasic_objects.html">#PB_Any</a> 
peut être utilisé pour générer automatiquement 
ce numéro. 

</td></tr>
<tr><td><i>NomFichier$</i></td>
<td> 
Le nom du fichier à ouvrir. 

</td></tr>
<tr><td><i>Options (optionnel)</i></td>
<td> 
Peut être une combinaison de: 
<pre><font face="Courier New, Courier, mono" size="2">  <font color="#924B72">#PB_File_SharedRead</font> : Le fichier ouvert peut être lu par un autre processus (Windows uniquement).
  <font color="#924B72">#PB_File_SharedWrite</font>: Le fichier ouvert peut être écrit par un autre processus (Windows uniquement).
  <font color="#924B72">#PB_File_Append</font>     : La position du pointeur de fichier sera fixée à la fin du fichier.
  <font color="#924B72">#PB_File_NoBuffering</font>: Le système interne de mise en mémoire tampon de PureBasic sera désactivé pour ce fichier. 
                        <a href="filebufferssize.html">FileBuffersSize()</a> ne peut pas être utilisé sur ce fichier.
</font></pre>
combiné avec l'une des valeurs suivantes (les options suivantes affectent le comportement de 
<a href="writestring.html">WriteString()</a>, <a href="writestringn.html">WriteStringN()</a>, <a href="readstring.html">ReadString()</a>, <a href="readcharacter.html">ReadCharacter()</a> et <a href="writecharacter.html">WriteCharacter()</a>): 
<pre><font face="Courier New, Courier, mono" size="2">  <font color="#924B72">#PB_Ascii</font>  : Toute opération de lecture/écriture des chaînes de caractères utilisera le mode ASCII
  <font color="#924B72">#PB_UTF8</font>   : Toute opération de lecture/écriture des chaînes de caractères utilisera le mode UTF-8 (Par défaut).
  <font color="#924B72">#PB_Unicode</font>: Toute opération de lecture/écriture des chaînes de caractères utilisera le mode Unicode.
</font></pre>

</td></tr>
</table>
</blockquote><p><b>Valeur de retour</b></p><blockquote>

Renvoie une valeur non nulle en cas de 
succès zéro sinon. 
<br>
<br>
Si <a href="../reference/purebasic_objects.html">#PB_Any</a> 
est utilisé pour le paramètre '#Fichier', 
le numéro du nouveau fichier sera renvoyé 
dans 'Resultat'. 

</blockquote><p><b>Remarques</b></p><blockquote>

Pour que l'ouverture du fichier avec 
OpenFile() soit un succès, le fichier doit 
avoir les droits en lecture et écriture. 
Ceci peut devenir un problème s'il faut 
manipuler des fichiers sur un CD-Rom par 
exemple. Dans ce cas, il convient 
d'utiliser <a href="readfile.html">ReadFile()</a> quand seule 
la lecture du fichier est nécessaire. 
<br>
<br>
Pour écraser un fichier existant avec un 
nouveau fichier vide, utilisez la fonction 
<a href="createfile.html">CreateFile()</a>. 
<br>
<br>
Pour ajouter des données à la fin d'un 
fichier existant il faut au préalable 
positionner le pointeur de lecture/écriture 
en utilisant l'option <font color="#924B72">#PB_File_Append</font>. 

</blockquote><p><b>Exemple</b></p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">If</font></b> <font color="#006666">OpenFile</font>(0, &quot;Test.txt&quot;)    <font color="#006666">; Ouvre un fichier existant ou en crée un nouveau s'il n'existait pas</font>
<font color="#006666">    FileSeek</font>(0,<font color="#006666"> Lof</font>(0))         <font color="#006666">; Place le pointeur à la fin du fichier en utilisant le résultat de Lof() </font>
<font color="#006666">    WriteStringN</font>(0, &quot;... une autre ligne à la fin du fichier.&quot;)
<font color="#006666">    CloseFile</font>(0)
  <b><font color="#006666">EndIf</font></b>
</font></pre>

</blockquote><p><b>Voir aussi</b></p><blockquote>

<a href="createfile.html">CreateFile()</a>, <a href="readfile.html">ReadFile()</a>, <a href="closefile.html">CloseFile()</a> 

</Blockquote><p><b>OS Supportés </b><Blockquote>Tous</Blockquote></p><center><- <a href=lof.html>Lof()</a> - <a href=index.html>File Index</a> - <a href=readasciicharacter.html>ReadAsciiCharacter()</a> -><br><br>

</body></html>