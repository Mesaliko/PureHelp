<html><head><title>DatabaseUpdate</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="4">DatabaseUpdate()</font></b></p>
<p><b>Syntax</b></p><blockquote>
Ergebnis = <font color="#006666"><b>DatabaseUpdate</b></font>(#Datenbank, Abfrage$)</blockquote>

</blockquote>
<b>Beschreibung</b><br><blockquote>

Führt eine Änderungs-Abfrage in der angegebenen Datenbank aus. Dieser Befehl gibt keine 
Einträge zurück. Um eine 'SELECT'-ähnliche Abfrage durchzuführen, verwenden Sie <a href="databasequery.html">DatabaseQuery()</a>. 

</blockquote><p><b>Parameter</b></p><blockquote>
<style type="text/css">
table.parameters { border-spacing: 0px; border-style: none; border-collapse: collapse; }
table.parameters td { border-width: 1px; padding: 6px; border-style: solid; border-color: gray; vertical-align: top; font-family:Arial; font-size:10pt; }
</style>
<table width="90%" class="parameters">
<tr><td width="10%"><i>#Datenbank</i></td>
<td width="90%"> 
Die zu verwendende Datenbank. 

</td></tr>
<tr><td><i>Abfrage$</i></td>
<td> 
Die auszuführende Abfrage. 

</td></tr>
</table>
</blockquote><p><b>Rückgabewert</b></p><blockquote>

Gibt einen Wert ungleich Null zurück, wenn die Abfrage erfolgreich war, oder Null wenn sie 
fehlgeschlagen ist (wegen eines SQL-Fehlers oder einer falsch formatierten Abfrage). 

</blockquote><p><b>Anmerkungen</b></p><blockquote>

Diese Funktion ist dem <a href="databasequery.html">DatabaseQuery()</a> Befehl ähnlich, ist jedoch unabhängig 
vom <a href="nextdatabaserow.html">NextDatabaseRow()</a> Befehl. Somit ist es nicht möglich, mit diesem Befehl 
eine Abfrage wie 'SELECT' auszuführen. Dieser Befehl ist nützlich für das Aktualisieren 
(Updaten) von Einträgen in der Datenbank. 
Im Falle eines Fehlers kann der Fehlertext mittels <a href="databaseerror.html">DatabaseError()</a> ermittelt werden. 
<br>
<br>
Die Update-Anforderung kann Platzhalter für Bindungsvariablen (englisch &quot;bind variables&quot;) enthalten. 
Solche Variablen müssen vor dem Aufruf der Funktion mittels <a href="setdatabasestring.html">SetDatabaseString()</a>, 
<a href="setdatabaselong.html">SetDatabaseLong()</a> etc. gesetzt werden. Nach dem Ausführen der Aktualisierung werden die 
gebundenen Variablen (englisch &quot;bound variables&quot;) gelöscht und müssen für zukünftige 
Aufrufe erneut festgelegt werden. Die Syntax für das Angeben der Bindungsvariablen in 
SQL ist abhängig von der Datenbank. Das Beispiel unten zeigt die Syntax. 

</blockquote><p><b>Beispiel</b></p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; Zuerst stellen wir eine Verbindung zu der 'employee' (Angestellten) Tabelle her</font>
  <font color="#006666">;</font>
  <b><font color="#006666">If</font></b> <font color="#006666">DatabaseQuery</font>(<font color="#924B72">#Datenbank</font>, &quot;SELECT * FROM employee&quot;) <font color="#006666">; Ermittelt alle Einträge in der 'employee' Tabelle</font>
  
    <b><font color="#006666">While</font></b> <font color="#006666">NextDatabaseRow</font>(<font color="#924B72">#Datenbank</font>)   <font color="#006666">; alle Einträge durchlaufen</font>
      
      <font color="#006666">; Aktualisieren des 'checked' Felds für jeden Eintrag, vorausgesetzt</font>
      <font color="#006666">; das 'id' Feld ist das erste in der 'employee' Tabelle</font>
      <font color="#006666">;</font>
<font color="#006666">      DatabaseUpdate</font>(<font color="#924B72">#Datenbank</font>, &quot;UPDATE employee SET checked=1 WHERE id=&quot;+<font color="#006666">GetDatabaseString</font>(<font color="#924B72">#Datenbank</font>, 0)) 
    <b><font color="#006666">Wend</font></b>

<font color="#006666">    FinishDatabaseQuery</font>(<font color="#924B72">#Datenbank</font>)
  <b><font color="#006666">EndIf</font></b>
</font></pre>

</blockquote><p><b>Beispiel:</b> Bindungsvariablen mit SQLite, MySQL und ODBC</p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; SQLite, MySQL und ODBC haben die gleiche Syntax für Bindungsvariablen. Diese werden durch das '?' Zeichen angegeben.</font>
  <font color="#006666">;</font>
<font color="#006666">  SetDatabaseLong</font>(0, 0, 1)
<font color="#006666">  SetDatabaseString</font>(0, 1, &quot;test&quot;)
<font color="#006666">  DatabaseUpdate</font>(0, &quot;UPDATE employee SET checked=? WHERE id=?&quot;)
</font></pre>

</blockquote><p><b>Beispiel:</b> PostgreSQL</p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; PostgreSQL verwendet eine andere Syntax: $1, $2.. innerhalb der Anweisung, um die undefinierten Parameter anzugeben</font>
  <font color="#006666">;</font>
<font color="#006666">  SetDatabaseLong</font>(0, 0, 1)
<font color="#006666">  SetDatabaseString</font>(0, 1, &quot;test&quot;)
<font color="#006666">  DatabaseUpdate</font>(0, &quot;UPDATE employee SET checked=$1 WHERE id=$2&quot;)
</font></pre>

</blockquote><p><b>Siehe auch</b></p><blockquote>

<a href="databasequery.html">DatabaseQuery()</a> 
<a href="setdatabasestring.html">SetDatabaseString()</a>, <a href="setdatabaselong.html">SetDatabaseLong()</a>, <a href="setdatabasequad.html">SetDatabaseQuad()</a>, <a href="setdatabasefloat.html">SetDatabaseFloat()</a>, <a href="setdatabasedouble.html">SetDatabaseDouble()</a> 
<a href="setdatabaseblob.html">SetDatabaseBlob()</a>, <a href="setdatabasenull.html">SetDatabaseNull()</a> 

</Blockquote><p><b>Unterstützte OS </b><Blockquote>Alle</Blockquote></p><center><- <a href=databasequery.html>DatabaseQuery()</a> - <a href=index.html>Database Inhaltsverzeichnis</a> - <a href=examinedatabasedrivers.html>ExamineDatabaseDrivers()</a> -><br><br>

</body></html>