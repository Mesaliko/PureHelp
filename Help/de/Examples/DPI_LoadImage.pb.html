<html><head><title>DPI_LoadImage.pb</title><meta charset=~"utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<pre><font face="Courier New, Courier, mono" size="2"><font color="#006666">;
</font><font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;
</font><font color="#006666">;   PureBasic - DPI Aware Load Image example file
</font><font color="#006666">;
</font><font color="#006666">;    (c) Fantaisie Software
</font><font color="#006666">;
</font><font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;
</font><font color="#006666">; This example shows how to load an image taking into account DPI
</font><font color="#006666">;
</font>
 <b><font color="#006666">Procedure</font></b> <font color="#006666">LoadImageDPI</font>(Image, File.s)
  <b><font color="#006666">Protected</font></b> Result
 
  Result =<font color="#006666"> LoadImage</font>(Image, File)
  <b><font color="#006666">If</font></b> Result
    <b><font color="#006666">If</font></b> Image = <font color="#924B72">#PB_Any</font>
<font color="#006666">      ResizeImage</font>(Result,<font color="#006666"> DesktopScaledX</font>(<font color="#006666">ImageWidth</font>(Result)),<font color="#006666"> DesktopScaledY</font>(<font color="#006666">ImageHeight</font>(Result)))
    <b><font color="#006666">Else</font></b>
<font color="#006666">      ResizeImage</font>(Image,<font color="#006666"> DesktopScaledX</font>(<font color="#006666">ImageWidth</font>(Image)),<font color="#006666"> DesktopScaledY</font>(<font color="#006666">ImageHeight</font>(Image)))
    <b><font color="#006666">EndIf</font></b>
  <b><font color="#006666">EndIf</font></b>
  <b><font color="#006666">ProcedureReturn</font></b> Result
 <b><font color="#006666">EndProcedure</font></b>

<b><font color="#006666">If</font></b> <font color="#006666">OpenWindow</font>(0, 0, 0, 200, 100, &quot;ButtonImage&quot;, <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_ScreenCentered</font>)
  <b><font color="#006666">If</font></b> <font color="#006666">LoadImageDPI</font>(0, <font color="#924B72">#PB_Compiler_Home</font> + &quot;/Examples/Sources/Data/PureBasic.bmp&quot;)
<font color="#006666">    ButtonImageGadget</font>(0, 10, 10, 180, 50,<font color="#006666"> ImageID</font>(0))
  <b><font color="#006666">EndIf</font></b>
  <b><font color="#006666">Repeat</font></b>
  <b><font color="#006666">Until</font></b> <font color="#006666">WaitWindowEvent</font>() = <font color="#924B72">#PB_Event_CloseWindow</font>
<b><font color="#006666">EndIf</font></b></font></pre>
</body></html>
