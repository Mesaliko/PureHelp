<html><head><title>Skeleton.pb</title><meta charset=~"utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<pre><font face="Courier New, Courier, mono" size="2">
<font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;
</font><font color="#006666">;   PureBasic - Skeleton
</font><font color="#006666">;
</font><font color="#006666">;    (c) Fantaisie Software
</font><font color="#006666">;
</font><font color="#006666">; ------------------------------------------------------------
</font><font color="#006666">;

</font><font color="#006666">InitEngine3D</font>():<font color="#006666">InitSprite</font>():<font color="#006666">InitKeyboard</font>():<font color="#006666">InitMouse</font>()

<font color="#006666">ExamineDesktops</font>():dx=<font color="#006666">DesktopWidth</font>(0)*0.8:dy=<font color="#006666">DesktopHeight</font>(0)*0.8
<font color="#006666">OpenWindow</font>(0, 0,0,<font color="#006666"> DesktopUnscaledX</font>(dx),<font color="#006666">DesktopUnscaledY</font>(dy), &quot;Billboard -  [F12]   [Pad1]   [Pad4]  [Esc] quit&quot;,<font color="#924B72">#PB_Window_ScreenCentered</font>)
<font color="#006666">OpenWindowedScreen</font>(<font color="#006666">WindowID</font>(0), 0, 0, dx, dy, 0, 0, 0)

<font color="#006666">CreateCamera</font>(0, 0, 0, 100, 100):<font color="#006666">MoveCamera</font>(0,0,2,8):<font color="#006666">CameraLookAt</font>(0,0,2,0):<font color="#006666">CameraBackColor</font>(0,$446666)
<font color="#006666">CreateLight</font>(0,$ffffff, -1000, 1000, 0)
<font color="#006666">AmbientColor</font>($444444)

<font color="#006666">CreateShaderMaterial</font>(0,<font color="#924B72">#PB_Material_ColorShader</font>)
<font color="#006666">SetMaterialColor</font>(0,<font color="#924B72">#PB_Material_AmbientColor</font>|<font color="#924B72">#PB_Material_DiffuseColor</font>,$ff):<font color="#006666">MaterialShininess</font>(0,64,$ffffff)
<font color="#006666">MaterialCullingMode</font>(0,<font color="#924B72">#PB_Material_NoCulling</font>)

<b><font color="#006666">Define</font></b> ns=4     <font color="#006666">; section number (joint)
</font><b><font color="#006666">Define</font></b> lgs=2    <font color="#006666">; section lenght
</font><b><font color="#006666">Define</font></b> r.f=0.2  <font color="#006666">; section radius
</font><b><font color="#006666">Define</font></b> ni=8 ,nj=16, w.f,ai.f <font color="#006666">; for mesh description

</font><font color="#006666">; ----------- mesh creation
</font><b><font color="#006666">Dim</font></b> <font color="#006666">t</font>.MeshVertex((nj+1)*(ns)-1,ni)
<b><font color="#006666">For</font></b> s=0 <b><font color="#006666">To</font></b> ns-1
  <b><font color="#006666">For</font></b> j=0 <b><font color="#006666">To</font></b> nj
    <b><font color="#006666">For</font></b> i=0 <b><font color="#006666">To</font></b> ni
      <b><font color="#006666">With</font></b> <font color="#006666">t</font>(s*(nj+1)+j,i) 
        ai=i/ni*2*<font color="#924B72">#PI</font>
        \x=-<font color="#006666">Cos</font>(ai)*r
        \z=<font color="#006666">Sin</font>(ai)*r
        \y=(0.0+s+j/nj)*lgs
        \u=i/4
        \v=j/16
        \Color=$ffffff
        \NormalX=\x
        \Normaly=0
        \Normalz=\z
      <b><font color="#006666">EndWith</font></b> 
    <b><font color="#006666">Next</font></b>
  <b><font color="#006666">Next</font></b>
<b><font color="#006666">Next</font></b>
<font color="#006666">CreateDataMesh</font>(0,<font color="#006666">t</font>())

<font color="#006666">; ----------- skeleton/joints creation
</font><b><font color="#006666">Define</font></b> joint.s,pjoint.s
<font color="#006666">CreateSphere</font>(100,0.05)
<font color="#006666">CreateMaterial</font>(100,0,$ffffff)

<font color="#006666">CreateSkeleton</font>(0)
<b><font color="#006666">For</font></b> s=0 <b><font color="#006666">To</font></b> ns
  pjoint=joint
  joint=&quot;joint&quot;+s
<font color="#006666">  CreateBone</font>(0,joint,pjoint,0,lgs*s,0,0,0,0,0,0)
<font color="#006666">  CreateEntity</font>(100+s,<font color="#006666">MeshID</font>(100),<font color="#006666">MaterialID</font>(100))
<b><font color="#006666">Next</font></b>

<font color="#006666">; ----------- Vertex Bone Assignment
</font><b><font color="#006666">For</font></b> s=0 <b><font color="#006666">To</font></b> ns
  <b><font color="#006666">For</font></b> j=0 <b><font color="#006666">To</font></b> nj
    <b><font color="#006666">For</font></b> i=0 <b><font color="#006666">To</font></b> ni
      vi=(s*(nj+1)+j)*(ni+1)+i
      v.f=s+j/nj-0.5:<b><font color="#006666">If</font></b> v&lt;0:v=0:<b><font color="#006666">EndIf</font></b>
      w=<font color="#006666">Mod</font>(v,1)
      bi=<font color="#006666">Int</font>(v)
<font color="#006666">      VertexBoneAssignment</font>(0,0,vi,bi+0,1-w)
<font color="#006666">      VertexBoneAssignment</font>(0,0,vi,bi+1,w)
    <b><font color="#006666">Next</font></b>
  <b><font color="#006666">Next</font></b>
<b><font color="#006666">Next</font></b>
<font color="#006666">FinishBoneAssignment</font>(0,0)

<font color="#006666">CreateEntity</font>(0,<font color="#006666">MeshID</font>(0),<font color="#006666">MaterialID</font>(0))

<b><font color="#006666">For</font></b> s=0 <b><font color="#006666">To</font></b> ns
<font color="#006666">  EnableManualEntityBoneControl</font>(0, &quot;joint&quot;+s, <font color="#924B72">#True</font>, <font color="#924B72">#True</font>)
<b><font color="#006666">Next</font></b>

<b><font color="#006666">Define</font></b>.f MouseX,Mousey,depx,depz,dist,rotx,Wireframe.b=1,angle.f


<b><font color="#006666">Repeat</font></b>
  <b><font color="#006666">While</font></b> <font color="#006666">WindowEvent</font>():<b><font color="#006666">Wend</font></b>
<font color="#006666">  ExamineKeyboard</font>()
<font color="#006666">  ExamineMouse</font>()
  
  depx=(-<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Left</font>))+<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Right</font>)))*0.1
  depz=(-<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Down</font>))+<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Up</font>   )))*0.1+<font color="#006666">MouseWheel</font>()
  <b><font color="#006666">If</font></b> <font color="#006666">KeyboardReleased</font>(<font color="#924B72">#PB_Key_F12</font>):Wireframe=1-Wireframe:<b><font color="#006666">EndIf</font></b>:<b><font color="#006666">If</font></b> Wireframe:<font color="#006666">MaterialShadingMode</font>(0, <font color="#924B72">#PB_Material_Wireframe</font>):<b><font color="#006666">Else</font></b>:<font color="#006666">MaterialShadingMode</font>(0,<font color="#924B72">#PB_Material_Solid</font>):<b><font color="#006666">EndIf</font></b>
  MouseX = -<font color="#006666">MouseDeltaX</font>() *  0.05
  MouseY = -<font color="#006666">MouseDeltaY</font>() *  0.05
<font color="#006666">  RotateCamera</font>(0, MouseY, MouseX, 0, <font color="#924B72">#PB_Relative</font>)
  dist+(depz-dist)*0.05:<font color="#006666">MoveCamera  </font>(0, depX, 0, -dist)
  
  angle+0.01
  
  rotx+(-<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Pad1</font>))+<font color="#006666">Bool</font>(<font color="#006666">KeyboardPushed</font>(<font color="#924B72">#PB_Key_Pad4</font>)))
  <b><font color="#006666">For</font></b> s=0 <b><font color="#006666">To</font></b> ns
    joint=&quot;joint&quot;+s
    rotx=<font color="#006666">Sin</font>(angle+s*0.0002)*90
    <b><font color="#006666">If</font></b> s &amp; 1:sens=1:<b><font color="#006666">Else</font></b>:sens=-1:<b><font color="#006666">EndIf</font></b>
<font color="#006666">    RotateEntityBone</font>(0, joint, 0,0,sens*rotx, <font color="#924B72">#PB_Absolute</font>)
<font color="#006666">    MoveEntity</font>(100+s,<font color="#006666">EntityBoneX</font>(0,joint),<font color="#006666">EntityBoneY</font>(0,joint),<font color="#006666">EntityBoneZ</font>(0,joint),<font color="#924B72">#PB_Absolute</font>)
  <b><font color="#006666">Next</font></b>
  
<font color="#006666">  RenderWorld</font>()
<font color="#006666">  FlipBuffers</font>()    
<b><font color="#006666">Until</font></b> <font color="#006666">KeyboardReleased</font>(<font color="#924B72">#PB_Key_Escape</font>) <b><font color="#006666">Or</font></b> <font color="#006666">MouseButton</font>(3)

</font></pre>
</body></html>
