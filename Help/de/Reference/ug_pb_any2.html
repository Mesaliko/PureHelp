<html><head><title>UserGuide - Verwalten mehrerer Fenster mit unterschiedlichem Inhalt</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="5">UserGuide - Verwalten mehrerer Fenster mit unterschiedlichem Inhalt</font></b></p>

Im <a href="../reference/ug_pb_any1.html">vorangegangenen Artikel</a> haben wir einen Weg untersucht, 
wie ein Programm mehrere Ausgaben eines einzelnen <a href="../window/index.html">Fenster</a>-Typs 
unterstützen kann. In diesem Artikel möchten wir dieses Konzept weiter ausbauen - indem 
wir ein Programm entwickeln, welches mehrere Instanzen unterschiedlicher Fenster 
unterstützt, in diesem Fall drei: 
<blockquote>

- Das Schalter (Button) Fenster – beinhaltet ein <a href="../gadget/listviewgadget.html">ListView</a> und zwei 
<a href="../gadget/buttongadget.html">Schalter</a> (Buttons) genannt 'Add' und 'Remove'. Wenn der 
Schalter 'Add' (Hinzufügen) angeklickt wird, dann wird eine <a href="../math/random.html">Zufallszahl</a> 
zum ListView hinzugefügt. Wenn der Schalter 'Remove' (Entfernen) angeklickt wird, dann 
wird der gerade im ListView ausgewählte Eintrag entfernt. 
<br>
- Das Datums (Date) Fenster – beinhaltet ein ListView und zwei Schalter der gleichen Art 
wie beim Schalter-Fenster, besitzt jedoch auch ein <a href="../gadget/calendargadget.html">CalendarGadget</a>, 
das Fenster-Layout wird wegen dieses zusätzlichen Gadgets angepasst. Wenn der Schalter 
'Add' angeklickt wird, dann wird das aktuell ausgewählte Datum zum ListView hinzugefügt. 
- Das Schieberegler (Track) Fenster - beinhaltet zwei <a href="../gadget/trackbargadget.html">TrackBars</a>, 
mit einem Wert zwischen 0 und 100, und ein <a href="../gadget/stringgadget.html">StringGadget</a>. 
Wenn die Schieberegler bewegt werden, dann wird das StringGadget aktualisiert - mit dem 
Wert des zweiten Schiebereglers subtrahiert vom ersten. 
</blockquote>


Jedes Fenster besitzt eine <a href="../menu/index.html">Menüleiste</a> mit Einträgen zum Erstellen einer 
neuen Instanz jedes der drei unterstützten Fenstertypen oder zum Schließen des aktuellen 
Fensters. 
<br>
<br>
Wesentliche Dinge, die es zu diesem Programm anzumerken gibt: 
<br>
<br>
Im Abschnitt &quot;Strukturen&quot; werden 4 <a href="../reference/structures.html">Strukturen</a> definiert. Die erste, 
BASEWINDOW, definiert einen WindowClass Wert und einen Menu Wert – diese Werte sind bei 
jedem Fenstertyp einheitlich. 
<br>
<br>
Die weiteren Strukturen erweitern die BASEWINDOW Struktur mit Werten für jedes der einmaligen 
Gadgets, welche von den jeweiligen Fenstertypen benötigt und nicht von BASEWINDOW Struktur 
angeboten werden. 
<br>
<br>
Im <a href="../reference/variables.html">Variablen</a> Abschnitt sehen Sie, dass erneut eine 
<a href="../reference/newmap.html">Map</a> names ActiveWindows erstellt wird, diesmal ist diese jedoch 
vom Typ Integer, sie verwendet keine der definierten Strukturen. Und dafür gibt es einen 
guten Grund: wir müssen drei verschiedene Struktur-Typen speichern, um dieses Programm 
lauffähig zu machen - und wir können dies nicht mit einer einzigen Map erreichen. 
<br>
<br>
Beachten Sie auch, dass *EventGadgets mittels der BASEWINDOW Struktur definiert wird. 
<br>
<br>
Werfen Sie nun einen Blick auf die CreateButtonWindow <a href="../reference/procedures.html">Prozedur</a>. 
Wie schon zuvor verwenden wir <a href="../reference/purebasic_objects.html">#PB_Any</a>, um die 
<a href="../window/index.html">Fenster</a> und alle seine <a href="../gadget/index.html">Gadgets</a> zu erstellen. 
<br>
<br>
Diesmal werden die Ergebnisse jedoch nicht direkt in der ActiveWindows Map gespeichert. 
Stattdessen verwenden wir die <a href="../memory/allocatememory.html">AllocateMemory</a> Funktion, um 
Speicher für eine BUTTONWINDOW Struktur zu reservieren, dann speichern wir einen 
<a href="../reference/memory.html">Zeiger</a> (Pointer) auf diesen Speicherbereich in der ActiveWindows 
Map. Damit umgehen wir das Problem, dass wir nicht alle drei verschiedenen Strukturen 
in der gleichen Map speichern können. 
<br>
<br>
Wir setzen auch den WindowClass Wert in der Struktur auf #WindowClassButton, um anzugeben, 
welcher Fenstertyp und somit welche Art von Struktur erstellt wurde - wir werden später 
darüber Bescheid wissen müssen. 
<br>
<br>
Es gibt zwei weitere CreateWindow Prozeduren dieses Mal - eine für jede Klasse (Class) der 
anderen Fenstertypen. Sie funktionieren auf ähnliche Art und Weise wie die beschriebene, und 
unterscheiden sich nur dadurch, dass die unterschiedlichen Gadgets berücksichtigt werden 
und ein anderer Wert in WindowClass gesetzt wird. 
<br>
<br>
Analog haben wir DestroyWindow und ResizeWindow Prozeduren, um auch diese Funktionen zu 
berücksichtigen. 
<br>
<br>
Wir haben auch eine neue Prozedur – EventsButtonWindow. Diese Prozedur weiß, was zu tun ist, 
wenn irgendeines der Gadgets auf dem Fenster durch den Anwender aktiviert wird. Ähnliche 
Prozeduren werden auch für die anderen Fenstertypen angeboten. 
<br>
<br>
In all diesen Prozeduren verwenden wir die ActiveWindows Map, um den Zeiger auf den 
jeweils reservierten Speicher zu erhalten. Wir können dann diesen Zeiger verwenden, um 
an die Referenzen der aktuellen Gadgets zu kommen, mit denen wir in jeder dieser 
Prozeduren arbeiten müssen: 
<pre><font face="Courier New, Courier, mono" size="2">  *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
  *ThisData\ListView ...
</font></pre>
Jeder Prozedur weiß nur, wie ein Typ von Fenster verwaltet werden kann - daher überprüfen 
wir vor den weiteren Schritten den WindowClass Wert, um sicherzugehen, dass ein Fenster 
mit einem korrekten Typ als Argument übermittelt wurde, etwa so hier: 
<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassButton</font>
</font></pre>
Die <a href="../window/waitwindowevent.html">Ereignis-Schleife</a> ist ebenfalls etwas anders. Für jeden 
Ereignis-Typ gibt es eine Bestimmung wie folgt: 
<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">; Verwende  *EventGadgets\WindowClass, um die korrekte Prozedur zur Größenänderung des Fensters aufzurufen.</font>
  <b><font color="#006666">Select</font></b> *EventtGadgets\WindowClass ...
</font></pre>

Obwohl die Speicherreservierungen letztlich von den CreateWindow Prozeduren des Typs 
BUTTONWINDOW, DATEWINDOW bzw. TRACKWINDOW durchgeführt werden, können wir hier trotzdem 
*EventGadgets verwenden, da dies im BASEWINDOW Typ definiert wurde, und BASEWINDOW die 
&quot;Vorgänger-Struktur&quot; (welche vererbt wird) für die anderen Strukturen ist. 
<br>
<br>
Sofern wir nicht versuchen, einen der gespeicherten Werte mit Hilfe von *EventGadgets zu 
ändern - und wir haben keinen Grund, dies zu tun - alles ist gut. 
<br>
<br>
Schlussendlich übertragen wir die in EventWindow, EventGadget, EventType aufgezeichneten 
Ereignis-Werte geradewegs zu den Ereignis-Prozeduren und überlassen diesen die weitere Arbeit. 

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#006666">;- Konstanten</font>
  <font color="#924B72">#DateFormat</font> = &quot;%dd/%mm/%yyyy&quot;
  
  <font color="#006666">;- Enumerations</font>
  <b><font color="#006666">Enumeration</font></b> 
    <font color="#924B72">#WindowClassButton</font> = 1
    <font color="#924B72">#WindowClassDate</font>
    <font color="#924B72">#WindowClassTrack</font>
  <b><font color="#006666">EndEnumeration</font></b>
  
  <font color="#006666">; Die Menü-Befehle sind die gleichen bei allen Fenstern.</font>
  <b><font color="#006666">Enumeration</font></b>
    <font color="#924B72">#MenuNewButton</font>
    <font color="#924B72">#MenuNewDate</font>
    <font color="#924B72">#MenuNewTrack</font>
    <font color="#924B72">#MenuClose</font>
  <b><font color="#006666">EndEnumeration</font></b>
  
  <font color="#006666">;- Strukturen</font>
  <b><font color="#006666">Structure</font></b> BASEWINDOW
    WindowClass.i 
    Menu.i  
  <b><font color="#006666">EndStructure</font></b>
  
  <b><font color="#006666">Structure</font></b> BUTTONWINDOW <b><font color="#006666">Extends</font></b> BASEWINDOW
    ListView.i
    AddButton.i
    RemoveButton.i  
  <b><font color="#006666">EndStructure</font></b>
  
  <b><font color="#006666">Structure</font></b> DATEWINDOW <b><font color="#006666">Extends</font></b> BASEWINDOW
    Calendar.i
    AddButton.i
    RemoveButton.i
    ListView.i
  <b><font color="#006666">EndStructure</font></b>
  
  <b><font color="#006666">Structure</font></b> TRACKWINDOW <b><font color="#006666">Extends</font></b> BASEWINDOW
    TrackBar1.i
    TrackBar2.i
    Label.i
    Difference.i
  <b><font color="#006666">EndStructure</font></b>
  
  <font color="#006666">;- Variablen</font>
  <font color="#006666">; Diese Map wird alle aktiven Fenster (wie zuvor) verwalten, da sich jedoch die Strukture für jede</font>
  <font color="#006666">; Fenster-Klasse unterscheidet, werden wir Zeiger auf die Strukturen (und nicht direkt die</font>
  <font color="#006666">; Gadget-Referenzen) in der Map speichern.</font>
  <b><font color="#006666">NewMap</font></b> <font color="#006666">ActiveWindows</font>.i()
  
  <font color="#006666">; Diese Werte werden verwenden, um neuen Fenstern ein eindeutige Kennzeichnung zu geben.</font>
  <b><font color="#006666">Define</font></b>.i Buttons, Dates, Tracks
  
  <font color="#006666">; Ereignis-Variablen.</font>
  <font color="#006666">; Beachte den Typ von *EventGadgets.</font>
  <b><font color="#006666">Define</font></b>.i Event, EventWindow, EventGadget, EventType, EventMenu, EventQuit
  <b><font color="#006666">Define</font></b>.s EventWindowKey
  <b><font color="#006666">Define</font></b> *EventGadgets.BASEWINDOW  
  
  <font color="#006666">;- Button (Schalter) Fenster</font>
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">CreateButtonWindow</font>()
    <font color="#006666">; Erstellt ein neues Button Fenster und fügt es zur überwachenden Map hinzu,</font>
    <font color="#006666">; reserviert Speicher für die Gadget-Referenzen, erstellt die Gadgets </font>
    <font color="#006666">; und speichert deren Referenzen in der Speicher-Struktur.</font>
    <b><font color="#006666">Shared</font></b> Buttons,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.BUTTONWINDOW
    <b><font color="#006666">Protected</font></b>.i ThisWindow
    <b><font color="#006666">Protected</font></b>.s ThisKey, ThisTitle
    
    <font color="#006666">; Festlegen des Fenstertitels.</font>
    Buttons + 1
    ThisTitle = &quot;Button Window &quot; +<font color="#006666"> StrU</font>(Buttons)
    
    <font color="#006666">; Öffnen des Fensters.</font>
    ThisWindow =<font color="#006666"> OpenWindow</font>(<font color="#924B72">#PB_Any</font>, 30, 30, 225, 300, ThisTitle, <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_SizeGadget</font> | <font color="#924B72">#PB_Window_MinimizeGadget</font> | <font color="#924B72">#PB_Window_TitleBar</font>)
    
    <font color="#006666">; Überprüfen, dass der OpenWindow Befehl erfolgreich funktioniert hat.</font>
    <b><font color="#006666">If</font></b> ThisWindow
      <font color="#006666">; Minimale Fenstergröße festlegen.</font>
<font color="#006666">      WindowBounds</font>(ThisWindow, 220, 100, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>)
      
      <font color="#006666">; Umwandeln der Fenster-Referenz in einen String, um diesen als Schlüssel für die Map zu verwenden.</font>
      ThisKey =<font color="#006666"> StrU</font>(ThisWindow)
      
      <font color="#006666">; Reserviert Speicher, um darin die Gadget-Referenzen zu speichern.</font>
      *ThisData =<font color="#006666"> AllocateMemory</font>(<font color="#006666">SizeOf</font>(BUTTONWINDOW))
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass die Speicherreservierung erfolgreich war.</font>
    <b><font color="#006666">If</font></b> *ThisData
      <font color="#006666">; Speichern der Fenster-Referenz und der Speicherzeiger-Werte in der Map.</font>
<font color="#006666">      ActiveWindows</font>(ThisKey) = *ThisData
      
      <font color="#006666">; Festlegen der Fenster-Klasse.</font>
      *ThisData\WindowClass = <font color="#924B72">#WindowClassButton</font>
      
      <font color="#006666">; Erstellen der Menüleiste.</font>
      *ThisData\Menu =<font color="#006666"> CreateMenu</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> WindowID</font>(ThisWindow))
      
      <font color="#006666">; Wenn die Menü-Erstellung erfolgreich war, die Menü-Einträge erstellen.</font>
      <b><font color="#006666">If</font></b> *ThisData\Menu
<font color="#006666">        MenuTitle</font>(&quot;Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewButton</font>, &quot;New Button Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewDate</font>, &quot;New Date Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewTrack</font>, &quot;New Track Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuClose</font>, &quot;Close Window&quot;)
      <b><font color="#006666">EndIf</font></b>
      
      <font color="#006666">; Erstellen der Fenster-Gadgets.</font>
      *ThisData\ListView =<font color="#006666"> ListViewGadget</font>(<font color="#924B72">#PB_Any</font>, 10, 10, 200, 225)
      *ThisData\AddButton =<font color="#006666"> ButtonGadget</font>(<font color="#924B72">#PB_Any</font>, 15, 245, 90, 30, &quot;Add&quot;)
      *ThisData\RemoveButton =<font color="#006666"> ButtonGadget</font>(<font color="#924B72">#PB_Any</font>, 115, 245, 90, 30, &quot;Remove&quot;)
    <b><font color="#006666">Else</font></b>
      <font color="#006666">; Speicherreservierung fehlgeschlagen.</font>
<font color="#006666">      CloseWindow</font>(ThisWindow)
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Festlegen des Rückgabewerts.</font>
    <b><font color="#006666">If</font></b> ThisWindow &gt; 0 <b><font color="#006666">And</font></b> *ThisData &gt; 0
      <font color="#006666">; Referenz auf das neue Fenster zurückgeben.</font>
      <b><font color="#006666">ProcedureReturn</font></b> ThisWindow
    <b><font color="#006666">Else</font></b>
      <font color="#006666">; 0 zurückgeben</font>
      <b><font color="#006666">ProcedureReturn</font></b> 0
    <b><font color="#006666">EndIf</font></b>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">DestroyButtonWindow</font>(Window.i)
    <font color="#006666">; Entfernt das Fenster aus der ActiveWindows Map, gibt den reservierten Speicher frei,</font>
    <font color="#006666">; schließt das Fenster und setzt das 'Beenden' (Quit) Flag, wenn nötig.</font>
    <b><font color="#006666">Shared</font></b> EventQuit,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.BUTTONWINDOW
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Umwandeln des Fenster-Werts in einen String.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassButton</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Die Speicherreservierung freigeben.</font>
<font color="#006666">    FreeMemory</font>(*ThisData)
    
    <font color="#006666">; Den Map-Eintrag löschen.</font>
<font color="#006666">    DeleteMapElement</font>(<font color="#006666">ActiveWindows</font>(), ThisKey)
    
    <font color="#006666">; Das Fenster schließen.</font>
<font color="#006666">    CloseWindow</font>(Window)
    
    <font color="#006666">; Überprüfen, ob es noch offene Fenster gibt.</font>
    <b><font color="#006666">If</font></b> <font color="#006666">MapSize</font>(<font color="#006666">ActiveWindows</font>()) = 0
      EventQuit = <font color="#924B72">#True</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Setzen des 'Erfolgreich' Rückgabewerts.</font>
    <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#True</font>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">ResizeButtonWindow</font>(Window.i)
    <font color="#006666">; Die Gadgets des Fensters in der Größe anpassen.</font>
    <b><font color="#006666">Shared</font></b> <font color="#006666">ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.BUTTONWINDOW
    <b><font color="#006666">Protected</font></b>.i X, Y, W, H
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassButton</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Listview in der Größe verändern.</font>
    W =<font color="#006666"> WindowWidth</font>(Window) - 25
    H =<font color="#006666"> WindowHeight</font>(Window) - 85
<font color="#006666">    ResizeGadget</font>(*ThisData\ListView, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>, W, H)
    
    <font color="#006666">; Schalter neu zentrieren.</font>
    X =<font color="#006666"> WindowWidth</font>(Window)/2 - 95
    Y =<font color="#006666"> WindowHeight</font>(Window) - 65
<font color="#006666">    ResizeGadget</font>(*ThisData\AddButton, X, Y, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>)
    
    X =<font color="#006666"> WindowWidth</font>(Window)/2 + 5
<font color="#006666">    ResizeGadget</font>(*ThisData\RemoveButton, X, Y, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>)
    
    <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#True</font>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">EventsButtonWindow</font>(Window, Gadget, Type)
    <font color="#006666">; Ereignisse für ein Button Fenster verarbeiten.</font>
    <b><font color="#006666">Shared</font></b> Buttons,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.BUTTONWINDOW
    <b><font color="#006666">Protected</font></b>.i NewValue, Index
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Umwandeln des Fenster-Werts in einen String.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassButton</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <b><font color="#006666">Select</font></b> Gadget
      <b><font color="#006666">Case</font></b> *ThisData\AddButton
        NewValue =<font color="#006666"> Random</font>(2147483647)
<font color="#006666">        AddGadgetItem</font>(*ThisData\ListView, -1,<font color="#006666"> StrU</font>(NewValue))
        
      <b><font color="#006666">Case</font></b> *ThisData\RemoveButton
        Index =<font color="#006666"> GetGadgetState</font>(*ThisData\ListView)
        <b><font color="#006666">If</font></b> Index &gt;= 0 <b><font color="#006666">And</font></b> Index &lt;=<font color="#006666"> CountGadgetItems</font>(*ThisData\ListView)
<font color="#006666">          RemoveGadgetItem</font>(*ThisData\ListView, Index)
        <b><font color="#006666">EndIf</font></b>
        
      <b><font color="#006666">Case</font></b> *ThisData\ListView
        <font color="#006666">; Tue nichts.</font>
    <b><font color="#006666">EndSelect</font></b>
  <b><font color="#006666">EndProcedure</font></b>
  
  <font color="#006666">;- Date Window</font>
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">CreateDateWindow</font>()
    <font color="#006666">; Erstellt ein neues Date Fenster und fügt es zur überwachenden Map hinzu,</font>
    <font color="#006666">; reserviert Speicher für die Gadget-Referenzen, erstellt die Gadgets </font>
    <font color="#006666">; und speichert deren Referenzen in der Speicher-Struktur.</font>
    <b><font color="#006666">Shared</font></b> Dates,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.DATEWINDOW
    <b><font color="#006666">Protected</font></b>.i ThisWindow
    <b><font color="#006666">Protected</font></b>.s ThisKey, ThisTitle
    
    Dates + 1
    ThisTitle = &quot;Date Window &quot; +<font color="#006666"> StrU</font>(Dates)
    ThisWindow =<font color="#006666"> OpenWindow</font>(<font color="#924B72">#PB_Any</font>, 30, 30, 310, 420, ThisTitle , <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_SizeGadget</font> | <font color="#924B72">#PB_Window_MinimizeGadget</font> | <font color="#924B72">#PB_Window_TitleBar</font>)
    
    <font color="#006666">; Überprüfen, dass der OpenWindow Befehl erfolgreich funktioniert hat.</font>
    <b><font color="#006666">If</font></b> ThisWindow
      <font color="#006666">; Minimale Fenstergröße festlegen.</font>
<font color="#006666">      WindowBounds</font>(ThisWindow, 310, 245, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>)
      
      <font color="#006666">; Umwandeln der Fenster-Referenz in einen String, um diesen als Schlüssel für die Map zu verwenden.</font>
      ThisKey =<font color="#006666"> StrU</font>(ThisWindow)
      
      <font color="#006666">; Reserviert Speicher, um darin die Gadget-Referenzen zu speichern.</font>
      *ThisData =<font color="#006666"> AllocateMemory</font>(<font color="#006666">SizeOf</font>(DATEWINDOW))
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass die Speicherreservierung erfolgreich war.</font>
    <b><font color="#006666">If</font></b> *ThisData
      <font color="#006666">; Speichern der Fenster-Referenz und der Speicherzeiger-Werte in der Map.</font>
<font color="#006666">      ActiveWindows</font>(ThisKey) = *ThisData
      
      <font color="#006666">; Festlegen der Fenster-Klasse.</font>
      *ThisData\WindowClass = <font color="#924B72">#WindowClassDate</font>
      
      <font color="#006666">; Erstellen der Menüleiste.</font>
      *ThisData\Menu =<font color="#006666"> CreateMenu</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> WindowID</font>(ThisWindow))
      
      <font color="#006666">; Wenn die Menü-Erstellung erfolgreich war, die Menü-Einträge erstellen.</font>
      <b><font color="#006666">If</font></b> *ThisData\Menu
<font color="#006666">        MenuTitle</font>(&quot;Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewButton</font>, &quot;New Button Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewDate</font>, &quot;New Date Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewTrack</font>, &quot;New Track Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuClose</font>, &quot;Close Window&quot;)
      <b><font color="#006666">EndIf</font></b>
      
      <font color="#006666">; Erstellen der Fenster-Gadgets.</font>
      *ThisData\Calendar =<font color="#006666"> CalendarGadget</font>(<font color="#924B72">#PB_Any</font>, 10, 10, 182, 162)
      *ThisData\AddButton =<font color="#006666"> ButtonGadget</font>(<font color="#924B72">#PB_Any</font>, 210, 10, 90, 30, &quot;Add&quot;)
      *ThisData\RemoveButton =<font color="#006666"> ButtonGadget</font>(<font color="#924B72">#PB_Any</font>, 210, 45, 90, 30, &quot;Remove&quot;)
      *ThisData\ListView =<font color="#006666"> ListViewGadget</font>(<font color="#924B72">#PB_Any</font>, 10, 187, 290, 200)
    <b><font color="#006666">Else</font></b>
      <font color="#006666">; Speicherreservierung fehlgeschlagen.</font>
<font color="#006666">      CloseWindow</font>(ThisWindow)
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Festlegen des Rückgabewerts.</font>
    <b><font color="#006666">If</font></b> ThisWindow &gt; 0 <b><font color="#006666">And</font></b> *ThisData &gt; 0 
      <font color="#006666">; Referenz auf das neue Fenster zurückgeben.</font>
      <b><font color="#006666">ProcedureReturn</font></b> ThisWindow
    <b><font color="#006666">Else</font></b>
      <font color="#006666">; 0 zurückgeben</font>
      <b><font color="#006666">ProcedureReturn</font></b> 0
    <b><font color="#006666">EndIf</font></b>
    
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">DestroyDateWindow</font>(Window.i)
    <font color="#006666">; Entfernt das Fenster aus der ActiveWindows Map, gibt den reservierten Speicher frei,</font>
    <font color="#006666">; schließt das Fenster und setzt das 'Beenden' (Quit) Flag, wenn nötig.</font>
    <b><font color="#006666">Shared</font></b> EventQuit,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.DATEWINDOW
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Umwandeln des Fenster-Werts in einen String.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen,</font>
    <font color="#006666">; da diese Prozedur dieses Fenster nicht schließen kann.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassDate</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Die Speicherreservierung freigeben.</font>
<font color="#006666">    FreeMemory</font>(*ThisData)
    
    <font color="#006666">; Den Map-Eintrag löschen.</font>
<font color="#006666">    DeleteMapElement</font>(<font color="#006666">ActiveWindows</font>(), ThisKey)
    
    <font color="#006666">; Das Fenster schließen.</font>
<font color="#006666">    CloseWindow</font>(Window)
    
    <font color="#006666">; Überprüfen, ob es noch offene Fenster gibt.</font>
    <b><font color="#006666">If</font></b> <font color="#006666">MapSize</font>(<font color="#006666">ActiveWindows</font>()) = 0
      EventQuit = <font color="#924B72">#True</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Setzen des 'Erfolgreich' Rückgabewerts.</font>
    <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#True</font>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">ResizeDateWindow</font>(Window.i)
    <font color="#006666">; Die Gadgets des Fensters in der Größe anpassen.</font>
    <b><font color="#006666">Shared</font></b> <font color="#006666">ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.DATEWINDOW
    <b><font color="#006666">Protected</font></b>.i X, Y, W, H
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassDate</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Listview in der Größe anpassen.</font>
    W =<font color="#006666"> WindowWidth</font>(Window) - 20
    H =<font color="#006666"> WindowHeight</font>(Window) - 220
<font color="#006666">    ResizeGadget</font>(*ThisData\ListView, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>, W, H)
    
    <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#True</font>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">EventsDateWindow</font>(Window, Gadget, Type)
    <font color="#006666">; Ereignisse für ein Date Fenster verarbeiten.</font>
    <b><font color="#006666">Shared</font></b> Buttons,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.DATEWINDOW
    <b><font color="#006666">Protected</font></b>.i NewValue, Index
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Umwandeln des Fenster-Werts in einen String.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassDate</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <b><font color="#006666">Select</font></b> Gadget
      <b><font color="#006666">Case</font></b> *ThisData\AddButton
        NewValue =<font color="#006666"> GetGadgetState</font>(*ThisData\Calendar)
<font color="#006666">        AddGadgetItem</font>(*ThisData\ListView, -1,<font color="#006666"> FormatDate</font>(<font color="#924B72">#DateFormat</font>, NewValue))
        
      <b><font color="#006666">Case</font></b> *ThisData\RemoveButton
        Index =<font color="#006666"> GetGadgetState</font>(*ThisData\ListView)
        <b><font color="#006666">If</font></b> Index &gt;= 0 <b><font color="#006666">And</font></b> Index &lt;=<font color="#006666"> CountGadgetItems</font>(*ThisData\ListView)
<font color="#006666">          RemoveGadgetItem</font>(*ThisData\ListView, Index)
        <b><font color="#006666">EndIf</font></b>
        
      <b><font color="#006666">Case</font></b> *ThisData\Calendar, *ThisData\ListView
        <font color="#006666">; Tue nichts.</font>
    <b><font color="#006666">EndSelect</font></b>
  <b><font color="#006666">EndProcedure</font></b>
  
  <font color="#006666">;- Track Window</font>
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">CreateTrackWindow</font>()
    <font color="#006666">; Erstellt ein neues Track Fenster und fügt es zur überwachenden Map hinzu,</font>
    <font color="#006666">; reserviert Speicher für die Gadget-Referenzen, erstellt die Gadgets </font>
    <font color="#006666">; und speichert deren Referenzen in der Speicher-Struktur.</font>
    <b><font color="#006666">Shared</font></b> Tracks,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.TRACKWINDOW
    <b><font color="#006666">Protected</font></b>.i ThisWindow, ThisSum
    <b><font color="#006666">Protected</font></b>.s ThisKey, ThisTitle
    
    Tracks + 1
    ThisTitle = &quot;Track Bar Window &quot; +<font color="#006666"> StrU</font>(Tracks)
    ThisWindow =<font color="#006666"> OpenWindow</font>(<font color="#924B72">#PB_Any</font>, 30, 30, 398, 130, ThisTitle, <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_SizeGadget</font> | <font color="#924B72">#PB_Window_MinimizeGadget</font> | <font color="#924B72">#PB_Window_TitleBar</font>)
    
    <font color="#006666">; Überprüfen, dass der OpenWindow Befehl erfolgreich funktioniert hat.</font>
    <b><font color="#006666">If</font></b> ThisWindow
      <font color="#006666">; Minimale Fenstergröße festlegen.</font>
<font color="#006666">      WindowBounds</font>(ThisWindow, 135, 130, <font color="#924B72">#PB_Ignore</font>, 130)
      
      <font color="#006666">; Umwandeln der Fenster-Referenz in einen String, um diesen als Schlüssel für die Map zu verwenden.</font>
      ThisKey =<font color="#006666"> StrU</font>(ThisWindow)
      
      <font color="#006666">; Reserviert Speicher, um darin die Gadget-Referenzen zu speichern.</font>
      *ThisData =<font color="#006666"> AllocateMemory</font>(<font color="#006666">SizeOf</font>(TRACKWINDOW))
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass die Speicherreservierung erfolgreich war.</font>
    <b><font color="#006666">If</font></b> *ThisData
      <font color="#006666">; Speichern der Fenster-Referenz und der Speicherzeiger-Werte in der Map.</font>
<font color="#006666">      ActiveWindows</font>(ThisKey) = *ThisData
      
      <font color="#006666">; Festlegen der Fenster-Klasse.</font>
      *ThisData\WindowClass = <font color="#924B72">#WindowClassTrack</font>
      
      <font color="#006666">; Erstellen der Menüleiste.</font>
      *ThisData\Menu =<font color="#006666"> CreateMenu</font>(<font color="#924B72">#PB_Any</font>,<font color="#006666"> WindowID</font>(ThisWindow))
      
      <font color="#006666">; Wenn die Menü-Erstellung erfolgreich war, die Menü-Einträge erstellen.</font>
      <b><font color="#006666">If</font></b> *ThisData\Menu
<font color="#006666">        MenuTitle</font>(&quot;Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewButton</font>, &quot;New Button Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewDate</font>, &quot;New Date Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuNewTrack</font>, &quot;New Track Window&quot;)
<font color="#006666">        MenuItem</font>(<font color="#924B72">#MenuClose</font>, &quot;Close Window&quot;)
      <b><font color="#006666">EndIf</font></b>
      
      <font color="#006666">; Erstellen der Fenster-Gadgets.</font>
      *ThisData\TrackBar1 =<font color="#006666"> TrackBarGadget</font>(<font color="#924B72">#PB_Any</font>, 10, 10, 375, 25, 0, 100, <font color="#924B72">#PB_TrackBar_Ticks</font>)
      *ThisData\TrackBar2 =<font color="#006666"> TrackBarGadget</font>(<font color="#924B72">#PB_Any</font>, 10, 40, 375, 25, 0, 100, <font color="#924B72">#PB_TrackBar_Ticks</font>)
      *ThisData\Label =<font color="#006666"> TextGadget</font>(<font color="#924B72">#PB_Any</font>, 10, 75, 80, 25, &quot;Difference:&quot;)
      *ThisData\Difference =<font color="#006666"> StringGadget</font>(<font color="#924B72">#PB_Any</font>, 90, 75, 290, 25, &quot;0&quot;, <font color="#924B72">#PB_String_ReadOnly</font>)
    <b><font color="#006666">Else</font></b>
      <font color="#006666">; Speicherreservierung fehlgeschlagen.</font>
<font color="#006666">      CloseWindow</font>(ThisWindow)
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Festlegen des Rückgabewerts.</font>
    <b><font color="#006666">If</font></b> ThisWindow &gt; 0 <b><font color="#006666">And</font></b> *ThisData &gt; 0
      <font color="#006666">; Referenz auf das neue Fenster zurückgeben.</font>
      <b><font color="#006666">ProcedureReturn</font></b> ThisWindow
    <b><font color="#006666">Else</font></b>
      <font color="#006666">; 0 zurückgeben</font>
      <b><font color="#006666">ProcedureReturn</font></b> 0
    <b><font color="#006666">EndIf</font></b>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">DestroyTrackWindow</font>(Window.i)
    <font color="#006666">; Entfernt das Fenster aus der ActiveWindows Map, gibt den reservierten Speicher frei,</font>
    <font color="#006666">; schließt das Fenster und setzt das 'Beenden' (Quit) Flag, wenn nötig.</font>
    <b><font color="#006666">Shared</font></b> EventQuit,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.DATEWINDOW
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Umwandeln des Fenster-Werts in einen String.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen,</font>
    <font color="#006666">; da diese Prozedur dieses Fenster nicht schließen kann.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassTrack</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Die Speicherreservierung freigeben.</font>
<font color="#006666">    FreeMemory</font>(*ThisData)
    
    <font color="#006666">; Den Map-Eintrag löschen.</font>
<font color="#006666">    DeleteMapElement</font>(<font color="#006666">ActiveWindows</font>(), ThisKey)
    
    <font color="#006666">; Das Fenster schließen.</font>
<font color="#006666">    CloseWindow</font>(Window)
    
    <font color="#006666">; Überprüfen, ob es noch offene Fenster gibt.</font>
    <b><font color="#006666">If</font></b> <font color="#006666">MapSize</font>(<font color="#006666">ActiveWindows</font>()) = 0
      EventQuit = <font color="#924B72">#True</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Setzen des 'Erfolgreich' Rückgabewerts.</font>
    <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#True</font>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">ResizeTrackWindow</font>(Window.i)
    <font color="#006666">; Die Gadgets des Fensters in der Größe anpassen.</font>
    <b><font color="#006666">Shared</font></b> <font color="#006666">ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.TRACKWINDOW
    <b><font color="#006666">Protected</font></b>.i X, Y, W, H
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassTrack</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Trackbars (Schieberegler) in der Größe anpassen.</font>
    W =<font color="#006666"> WindowWidth</font>(Window) - 20
<font color="#006666">    ResizeGadget</font>(*ThisData\TrackBar1, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>, W, <font color="#924B72">#PB_Ignore</font>)
<font color="#006666">    ResizeGadget</font>(*ThisData\TrackBar2, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>, W, <font color="#924B72">#PB_Ignore</font>)
    
    <font color="#006666">; StringGadget anpassen.</font>
    W =<font color="#006666"> WindowWidth</font>(Window) - 110
<font color="#006666">    ResizeGadget</font>(*ThisData\Difference, <font color="#924B72">#PB_Ignore</font>, <font color="#924B72">#PB_Ignore</font>, W, <font color="#924B72">#PB_Ignore</font>)
    
    <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#True</font>
  <b><font color="#006666">EndProcedure</font></b>
  
  <b><font color="#006666">Procedure</font></b>.i <font color="#006666">EventsTrackWindow</font>(Window, Gadget, Type)
    <font color="#006666">; Ereignisse für ein Track Fenster verarbeiten.</font>
    <b><font color="#006666">Shared</font></b> Buttons,<font color="#006666"> ActiveWindows</font>()
    <b><font color="#006666">Protected</font></b> *ThisData.TRACKWINDOW
    <b><font color="#006666">Protected</font></b>.i NewValue
    <b><font color="#006666">Protected</font></b>.s ThisKey
    
    <font color="#006666">; Umwandeln des Fenster-Werts in einen String.</font>
    ThisKey =<font color="#006666"> StrU</font>(Window)
    
    <font color="#006666">; Referenz-Strukturenzeiger ermitteln.</font>
    *ThisData =<font color="#006666"> ActiveWindows</font>(ThisKey)
    
    <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData = 0
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <font color="#006666">; Überprüfen, dass es sich um den korrekten Fenstertyp handelt, sonst stoppen.</font>
    <b><font color="#006666">If</font></b> *ThisData\WindowClass &lt;&gt; <font color="#924B72">#WindowClassTrack</font>
      <b><font color="#006666">ProcedureReturn</font></b> <font color="#924B72">#False</font>
    <b><font color="#006666">EndIf</font></b>
    
    <b><font color="#006666">Select</font></b> Gadget
      <b><font color="#006666">Case</font></b> *ThisData\TrackBar1, *ThisData\TrackBar2
        NewValue =<font color="#006666"> GetGadgetState</font>(*ThisData\TrackBar1) -<font color="#006666"> GetGadgetState</font>(*ThisData\TrackBar2)
<font color="#006666">        SetGadgetText</font>(*ThisData\Difference,<font color="#006666"> Str</font>(NewValue))
        
      <b><font color="#006666">Case</font></b> *ThisData\Label, *ThisData\Difference
        <font color="#006666">; Tue nichts.</font>
    <b><font color="#006666">EndSelect</font></b>
  <b><font color="#006666">EndProcedure</font></b>
  
  <font color="#006666">;- Main</font>
  
  <font color="#006666">; Erstellen des ersten Fensters.</font>
  EventWindow =<font color="#006666"> CreateButtonWindow</font>()
<font color="#006666">  ResizeButtonWindow</font>(EventWindow)
  
  <font color="#006666">;- Ereignis-Schleife</font>
  <b><font color="#006666">Repeat</font></b>
    Event =<font color="#006666"> WaitWindowEvent</font>()
    EventWindow =<font color="#006666"> EventWindow</font>()
    EventWindowKey =<font color="#006666"> StrU</font>(EventWindow)
    EventGadget =<font color="#006666"> EventGadget</font>()
    EventType =<font color="#006666"> EventType</font>()
    EventMenu =<font color="#006666"> EventMenu</font>()
    *EventGadgets =<font color="#006666"> ActiveWindows</font>(EventWindowKey)
    
    <b><font color="#006666">Select</font></b> Event
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_Gadget</font>
        <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde.</font>
        <b><font color="#006666">If</font></b> *EventGadgets &gt; 0
          <font color="#006666">; Verwenden von *EventGadgets\WindowClass, um Ereignisse an die richtige Ereignis-Prozedur zu übermitteln.</font>
          <b><font color="#006666">Select</font></b> *EventGadgets\WindowClass
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassButton</font>
<font color="#006666">              EventsButtonWindow</font>(EventWindow, EventGadget, EventType)
              
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassDate</font>
<font color="#006666">              EventsDateWindow</font>(EventWindow, EventGadget, EventType)
              
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassTrack</font>
<font color="#006666">              EventsTrackWindow</font>(EventWindow, EventGadget, EventType)
              
            <b><font color="#006666">Default</font></b>
              <font color="#006666">; Tue nichts.</font>
          <b><font color="#006666">EndSelect</font></b>
        <b><font color="#006666">EndIf</font></b>
        
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_Menu</font>
        <b><font color="#006666">Select</font></b> EventMenu
          <b><font color="#006666">Case</font></b> <font color="#924B72">#MenuNewButton</font>
            EventWindow =<font color="#006666"> CreateButtonWindow</font>()
            <b><font color="#006666">If</font></b> EventWindow &gt; 0
<font color="#006666">              ResizeButtonWindow</font>(EventWindow)
            <b><font color="#006666">EndIf</font></b>
            
          <b><font color="#006666">Case</font></b> <font color="#924B72">#MenuNewDate</font>
            EventWindow =<font color="#006666"> CreateDateWindow</font>()
            <b><font color="#006666">If</font></b> EventWindow &gt; 0
<font color="#006666">              ResizeDateWindow</font>(EventWindow)
            <b><font color="#006666">EndIf</font></b>
            
          <b><font color="#006666">Case</font></b> <font color="#924B72">#MenuNewTrack</font>
            EventWindow =<font color="#006666"> CreateTrackWindow</font>()
            <b><font color="#006666">If</font></b> EventWindow &gt; 0
<font color="#006666">              ResizeTrackWindow</font>(EventWindow)
            <b><font color="#006666">EndIf</font></b>
            
          <b><font color="#006666">Case</font></b> <font color="#924B72">#MenuClose</font>
            <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde.</font>
            <b><font color="#006666">If</font></b> *EventGadgets &gt; 0
              <font color="#006666">; Verwenden von *EventGadgets\WindowClass, um die richtige Prozedur zum Löschen des Fensters aufzurufen.</font>
              <b><font color="#006666">Select</font></b> *EventGadgets\WindowClass
                <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassButton</font>
<font color="#006666">                  DestroyButtonWindow</font>(EventWindow)
                  
                <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassDate</font>
<font color="#006666">                  DestroyDateWindow</font>(EventWindow)
                  
                <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassTrack</font>
<font color="#006666">                  DestroyTrackWindow</font>(EventWindow)
                  
                <b><font color="#006666">Default</font></b>
                  <font color="#006666">; Tue nichts.</font>
              <b><font color="#006666">EndSelect</font></b>
            <b><font color="#006666">EndIf</font></b>
        <b><font color="#006666">EndSelect</font></b>
        
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_CloseWindow</font>
        <font color="#006666">; Überprüfen, dass ein gültiger Zeiger ermittelt wurde.</font>
        <b><font color="#006666">If</font></b> *EventGadgets &gt; 0
          <font color="#006666">; Verwenden von *EventGadgets\WindowClass, um die richtige Prozedur zum Löschen des Fensters aufzurufen.</font>
          <b><font color="#006666">Select</font></b> *EventGadgets\WindowClass
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassButton</font>
<font color="#006666">              DestroyButtonWindow</font>(EventWindow)
              
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassDate</font>
<font color="#006666">              DestroyDateWindow</font>(EventWindow)
              
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassTrack</font>
<font color="#006666">              DestroyTrackWindow</font>(EventWindow)
              
            <b><font color="#006666">Default</font></b>
              <font color="#006666">; Tue nichts.</font>
          <b><font color="#006666">EndSelect</font></b>
        <b><font color="#006666">EndIf</font></b>
        
      <b><font color="#006666">Case</font></b> <font color="#924B72">#PB_Event_SizeWindow</font>     
        <b><font color="#006666">If</font></b> *EventGadgets &gt; 0
          <font color="#006666">; Verwende  *EventGadgets\WindowClass, um die korrekte Prozedur zur Größenänderung des Fensters aufzurufen.</font>
          <b><font color="#006666">Select</font></b> *EventGadgets\WindowClass
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassButton</font>
<font color="#006666">              ResizeButtonWindow</font>(EventWindow)
              
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassDate</font>
<font color="#006666">              ResizeDateWindow</font>(EventWindow)
              
            <b><font color="#006666">Case</font></b> <font color="#924B72">#WindowClassTrack</font>
<font color="#006666">              ResizeTrackWindow</font>(EventWindow)
              
            <b><font color="#006666">Default</font></b>
              <font color="#006666">; Tue nichts.</font>
          <b><font color="#006666">EndSelect</font></b>
        <b><font color="#006666">EndIf</font></b>
        
    <b><font color="#006666">EndSelect</font></b>
    
  <b><font color="#006666">Until</font></b> EventQuit = <font color="#924B72">#True</font>
</font></pre>

<p><b>Einsteiger-Kapitel Navigation</b></p><blockquote>

<a href="../reference/ug_pb_any1.html">< Vorheriges: Dynamische Nummerierung von Fenstern und Gadgets</a> | <a href="../reference/ug_overview.html">Überblick</a> | <a href="../reference/ug_keywords.html">Nächstes: Andere Compiler-Schlüsselworte ></a> 
</blockquote>
</font></body></html>