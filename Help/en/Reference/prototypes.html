<html><head><title>Prototypes</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="5">Prototypes</font></b></p>

<br><b>Syntax</b><blockquote><pre><font face="Courier New, Courier, mono" size="2"><b><font color="#006666">Prototype</font></b>.&lt;type&gt; name(&lt;parameter&gt;, [, &lt;parameter&gt; [= DefaultValue]...])
</font></pre></blockquote>
<b>Description</b><br><blockquote>


For advanced programmers. <b><font color="#006666">Prototype</font></b> allows to declare a type which will map 
a function. It's useful when used with a variable, to do a function pointer (the 
variable value will be the address the function to call, and can be changed at will). 
<br>
<br>
This feature can replace the <a href="../library/openlibrary.html">OpenLibrary()</a> and 
<a href="../library/callfunction.html">CallFunction()</a> sequence as it has some 
advantages: type checking is done, number of of parameters is validated. 
<br>
<br>
Unlike CallFunction(), it can deal with double, float and quad <a href="../reference/variables.html">variables</a> 
without any problem. To get easily the pointer 
of a library function, use <a href="../library/getfunction.html">GetFunction()</a>. 
<br>
<br>
The last parameters can have a default value (need to be a constant expression), so if 
these parameters are omitted when the function is called, the default value will be used. 
<br>
<br>
By default the function will use the standard call convention (stdcall on x86, or fastcall on x64). If the function pointer will be 
a C one, the <b><font color="#006666">PrototypeC</font></b> variant should be used instead. For more information on library 
calling standards (cdecl, stdcall, fastcall), see <a href="https://en.wikipedia.org/wiki/Calling_convention">here</a>. 
<br>
<br>
The <a href="../reference/pseudotypes.html">pseudotypes</a> can be used for the parameters, but not for the returned 
value. 

</blockquote><p><b>Example</b></p><blockquote>


<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">CompilerIf</font></b> <font color="#924B72">#PB_Compiler_OS</font> &lt;&gt; <font color="#924B72">#PB_OS_Windows</font>
    <b><font color="#006666">CompilerError</font></b> &quot;This sample only works on Windows&quot;
  <b><font color="#006666">CompilerEndIf</font></b>

  <b><font color="#006666">Prototype</font></b>.i <font color="#006666">ProtoMessageBox</font>(Window.i, Body$, Title$, Flags.i = 0)

  <b><font color="#006666">If</font></b> <font color="#006666">OpenLibrary</font>(0, &quot;User32.dll&quot;)
   
    <font color="#006666">; 'MsgBox' is a variable with a 'ProtoMessageBox' type</font>
    <font color="#006666">;</font>
    MsgBox.ProtoMessageBox =<font color="#006666"> GetFunction</font>(0, &quot;MessageBoxW&quot;)
    
<font color="#006666">    MsgBox</font>(0, &quot;Hello&quot;, &quot;World&quot;) <font color="#006666">; We don't specify the flags</font>
  <b><font color="#006666">EndIf</font></b>
</font></pre>


</blockquote><p><b>Example:</b> With pseudotypes</p><blockquote>


<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">CompilerIf</font></b> <font color="#924B72">#PB_Compiler_OS</font> &lt;&gt; <font color="#924B72">#PB_OS_Windows</font>
    <b><font color="#006666">CompilerError</font></b> &quot;This sample only works on Windows&quot;
  <b><font color="#006666">CompilerEndIf</font></b>

  <font color="#006666">; We use the 'p-ascii' pseudotype for the string parameters, as</font>
  <font color="#006666">; MessageBoxA() is an ascii only function. The compiler will </font>
  <font color="#006666">; automatically converts the strings to unicode when needed.</font>
  <font color="#006666">;</font>
  <b><font color="#006666">Prototype</font></b>.i <font color="#006666">ProtoMessageBoxA</font>(Window.i, Body.p-ascii, Title.p-ascii, Flags.i = 0)

  <b><font color="#006666">If</font></b> <font color="#006666">OpenLibrary</font>(0, &quot;User32.dll&quot;)
   
    <font color="#006666">; 'MsgBox' is a variable with a 'ProtoMessageBoxA' type</font>
    <font color="#006666">;</font>
    MsgBox.ProtoMessageBoxA =<font color="#006666"> GetFunction</font>(0, &quot;MessageBoxA&quot;)
    
<font color="#006666">    MsgBox</font>(0, &quot;Hello&quot;, &quot;World&quot;) <font color="#006666">; We don't specify the flags</font>
  <b><font color="#006666">EndIf</font></b>
</font></pre>



</blockquote>
</font></body></html>