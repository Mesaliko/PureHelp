<html><head><title>Gestion des messages Windows</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="5">Gestion des messages Windows</font></b></p>

<p><b>Introduction</b></p><blockquote>


Les messages de votre programme seront transférés par Windows dans une file d'attente, 
qui est traitée uniquement si vous le désirez. 
Windows transmet un millier de messages à votre programme sans avertissement direct. <br>
<br>
Par exemple si vous changez le statut d'un gadget (que ce soit en ajoutant une saisie ou en changeant l'image d'un ImageGadget), 
un message est envoyé à la file d'attente de votre programme.  <br>
<br>
Il y a deux possibilités de récupérer et de traiter les messages Windows dans PureBasic : 
<a href="../window/waitwindowevent.html">WaitWindowEvent()</a> and <a href="../window/windowevent.html">WindowEvent()</a>. 
La différence est, que WaitWindowEvent() attend qu'un message arrive alors que WindowEvent() permet de continuer à travailler. 
Les messages dans la file d'attente ne seront cependant traités qu'après l'appel à WindowEvent() ou WaitWindowEvent(). 

</blockquote>
<p><b>Spécificités de WindowEvent()</b></p><blockquote>


La commande WindowEvent() n'attend pas, qu'un message arrive, mais vérifie seulement s'il y en a un dans la file d'attente. 
Si Oui, le message est traité et WindowEvent() renvoie le numéro du message. 
Si aucun message n'est dans la file, alors zéro (0) est renvoyé. 

<p><b>Exemple</b></p><blockquote>


<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">While</font></b> <font color="#006666">WindowEvent</font>() : <b><font color="#006666">Wend</font></b>
</font></pre>

Fait en sorte, que WindowEvent() soit appelée tant qu'elle ne renvoie pas 0, 
c'est à dire jusqu'à ce que tous les messages de la file d'attente soient traités <br>
<br>
Insérer un simple 'WindowEvent()' après un <a href="../gadget/setgadgetstate.html">SetGadgetState()</a> ne suffit pas pour traiter 
ce message en particulier. Premièrement il peut toujours y avoir d'autres messages dans la file d'attente, 
qui sont arrivés auparavant, et deuxièmement Windows envoie également un nombre conséquent d'autres messages, 
dont nous n'avons que faire... mais qui néanmoins sont dans la file d'attente.  <br>
<br>
Un simple appel à 
<pre><font face="Courier New, Courier, mono" size="2"><font color="#006666">  WindowEvent</font>()
</font></pre>
ne suffit pas, le programme peut fonctionner correctement dans certaines circonstances sur une version de Windows, 
mais pas sur une autre version. Les différentes versions de Windows ont un fonctionnement interne tellement spécifique, 
qu'une version envoie seulement 1 message mais une autre version peut envoyer 5 messages pour le même cas de figure. . <br>
<br>
A cause de cela, on utilise toujours pour la mise à jour : 
<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">While</font></b> <font color="#006666">WindowEvent</font>() : <b><font color="#006666">Wend</font></b>
</font></pre>
Bien sûr il y a aussi l'alternative 
<pre><font face="Courier New, Courier, mono" size="2">  <b><font color="#006666">Repeat</font></b> : <b><font color="#006666">Until</font></b> <font color="#006666">WindowEvent</font>() = 0
</font></pre>
possible, qui n'est cependant pas très courante.  <br>
<br>
La méthode While WindowEvent() : Wend est fréquemment utilisée avec la commande <a href="../system/delay.html">Delay()</a>, 
lorsqu'une une boucle est insérée AVANT le Delay(), par exemple pour attendre que la mise à jour d'un ImageGadget soit effective, 
après avoir changé une image avec SetGadgetState(). 
</blockquote>
</font></body></html>
