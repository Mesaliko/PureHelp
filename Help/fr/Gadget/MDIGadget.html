<html><head><title>MDIGadget</title><meta charset="utf-8"></head>
<body bgcolor="#FFFFDF" link="#009999" vlink="#006666" alink="#006666">
<font face="Arial" size="2"><p align="center"><b><font size="4">MDIGadget()</font></b></p>
<p><b>Syntaxe</b></p><blockquote>
Resultat = <font color="#006666"><b>MDIGadget</b></font>(#Gadget, X, Y, Largeur, Hauteur, SousMenu, ElementMenu [, Options])</blockquote>

</blockquote>
<b>Description</b><br><blockquote>

Crée un espace dans lequel peut s'afficher 
une ou plusieurs fenêtres filles. Ces 
fenêtres peuvent être librement déplacées 
et redimensionnées à l'intérieur de cet 
espace. Ce type de gestion de fenêtres 
s'appelle MDI (Multiple Document Interface). 

</blockquote><p><b>Arguments</b></p><blockquote>
<style type="text/css">
table.parameters { border-spacing: 0px; border-style: none; border-collapse: collapse; }
table.parameters td { border-width: 1px; padding: 6px; border-style: solid; border-color: gray; vertical-align: top; font-family:Arial; font-size:10pt; }
</style>
<table width="90%" class="parameters">
<tr><td width="10%"><i>#Gadget</i></td>
<td width="90%"> 
Le numéro d'identification du nouveau 
gadget. 
<br>
<br>
<a href="../reference/purebasic_objects.html">#PB_Any</a> 
peut être utilisé pour générer 
automatiquement ce numéro. 

</td></tr>
<tr><td><i>X, Y, Largeur, Hauteur</i></td>
<td> 
La position et les dimensions du nouveau 
gadget. 

</td></tr>
<tr><td><i>SousMenu</i></td>
<td> 
L'indice du menu pour lequel l'élément de 
fenêtres MDI doit être ajouté. 
<blockquote>

Un MDIGadget() a toujours besoin d'une 
fenêtre avec menu (voir <a href="../menu/createmenu.html">CreateMenu()</a>). 
Il n'est pas possible de créer plusieurs 
contrôles MDI dans une seule fenêtre, car 
il n'y a qu'un seul menu disponible par 
fenêtre. Une fois créé, le gadget mettra 
automatiquement à jour le menu auquel il 
est rattaché, avec la liste des fenêtres 
filles ouvertes. Dans le paramètre 
'SousMenu', il faut préciser l'index du 
sous-menu (créé avec <a href="../menu/menutitle.html">MenuTitle()</a>) qui sera 
le point d'attache aux éléments gérés par 
le gadget (l'index du premier sous-menu 
commence à 0). Le gadget ajoutera alors 
une barre de séparation à la fin de ce 
sous-menu et ajoutera la liste des fenêtres 
filles disponibles. 
</blockquote>


</td></tr>
<tr><td><i>ElementMenu</i></td>
<td> 
Le premier indice de menu à utiliser pour 
les fenêtres MDI. 
<blockquote>

Le gadget a besoin d'un certain nombre 
d'identifiants pour ses propres éléments 
du menu (voir le paramètre 'MenuID' de la 
commande <a href="../menu/menuitem.html">MenuItem()</a>). Dans le paramètre 
'ElementMenu', il faudra indiquer le 
chiffre à partir duquel le gadget pourra 
identifier ses propres éléments. Il 
utilisera autant d'identifiants  qu'il y 
aura de fenêtres filles ouvertes. Il est 
donc recommandé d'utiliser un nombre plus 
grand que le plus grand des nombres utilisé 
par les menus normaux du programme, pour 
éviter tout risque de collisions. 
</blockquote>


</td></tr>
<tr><td><i>Options (optionnel)</i></td>
<td> 
Peut être une combinaison de: 
<pre><font face="Courier New, Courier, mono" size="2">  <font color="#924B72">#PB_MDI_AutoSize</font>    : Le gadget sera automatiquement redimensionné en fonction de la taille de la fenêtre mère.
                        S'il n'y a pas d'autres gadgets sur la fenêtre mère, cela peut être une option très pratique.
  <font color="#924B72">#PB_MDI_BorderLess</font>  : Il n'y aura pas de bords autour du gadget.
  <font color="#924B72">#PB_MDI_NoScrollBars</font>: Quand une fenêtre est déplacée en dehors de l'espace du gadget, il n'y aura pas de barres de défilement.
</font></pre>

</td></tr>
</table>
</blockquote><p><b>Valeur de retour</b></p><blockquote>

Renvoie une valeur non nulle en cas de 
succès, zéro sinon. 
<br>
<br>
Si <font color="#924B72">#PB_Any</font> a été utilisé pour le paramètre 
#Gadget, alors la valeur de retour est le 
numéro d'identification du gadget, généré 
automatiquement. 

</blockquote><p><b>Remarques</b></p><blockquote>

A cause de la connexion avec les menus, 
il ne peut y avoir qu'un seul gadget MDI 
par fenêtre, cependant vous pouvez utiliser 
plusieurs fenêtres contenant un gadget MDI 
chacune. Ce gadget ne peut être créé que 
dans une fenêtre principale  donc pas dans 
un <a href="containergadget.html">ContainerGadget()</a>, <a href="splittergadget.html">SplitterGadget()</a> ou 
<a href="panelgadget.html">PanelGadget()</a>). 
<br>
Comme l'intérêt premier de ce gadget est 
de gérer de manière dynamique des fenêtres, 
il est recommandé d'utiliser <font color="#924B72">#PB_Any</font> 
(création dynamique) pour les gadgets qui 
seront créés dans les fenêtres filles. 
<br>
<br>
Quand la commande <a href="addgadgetitem.html">AddGadgetItem()</a> est 
utilisée avec ce gadget, l'élément créé 
est en fait une nouvelle 
<a href="../window/index.html">fenêtre</a>.<br>
Ainsi, toutes les commandes de la 
bibliothèque <a href="../window/index.html">Window</a> 
sont disponibles pour gérer cette nouvelle 
fenêtre (sauf <a href="../window/stickywindow.html">StickyWindow()</a>). 
Le numéro choisi pour cet élément ne doit 
pas entrer en conflit avec un numéro de 
fenêtre déjà existant sinon l'autre fenêtre 
sera fermée. Le gadget MDI ne génère pas 
d'évènements. Les évènements concernant les 
fenêtres MDI filles seront reçus comme des 
<a href="../window/waitwindowevent.html">évènements fenêtre</a> 
normaux (<font color="#924B72">#PB_Event_SizeWindow</font>, 
<font color="#924B72">#PB_Event_CloseWindow</font>, ...). 

<pre><font face="Courier New, Courier, mono" size="2">  - <a href="gadgettooltip.html">GadgetToolTip()</a> permet d'ajouter une 'mini aide' à ce gadget. 

  En complément des commandes de la bibliothèque <a href="../window/index.html">Window</a> (sauf <a href="../window/stickywindow.html">StickyWindow()</a>), 
  les commandes suivantes sont disponibles pour agir sur le gadget: 
  - <a href="countgadgetitems.html">CountGadgetItems()</a>  : Renvoie le nombre de fenêtres fille. 
  - <a href="addgadgetitem.html">AddGadgetItem()</a>     : Crée une nouvelle fenêtre fille. 
  - <a href="cleargadgetitems.html">ClearGadgetItems()</a>  : Ferme toutes les fenêtres filles. 
  - <a href="getgadgetstate.html">GetGadgetState()</a>    : Renvoie l'identifiant de la fenêtre fille active. 
  - <a href="setgadgetstate.html">SetGadgetState()</a>    : Change la fenêtre fille active ou ré-arrange la disposition des fenêtres filles (voir <a href="getgadgetstate.html">GetGadgetState()</a>). 
  - <a href="setgadgetattribute.html">SetGadgetAttribute()</a>: Avec une des constantes suivantes:
    <font color="#924B72">#PB_MDI_Image</font>    : Applique une image de fond à la fenêtre MDI.
    <font color="#924B72">#PB_MDI_TileImage</font>: Applique une image de fond à la fenêtre MDI. 
                       L'image est répétée le nombre de fois nécessaire
                       pour remplir complètement la surface de la fenêtre.

  - <a href="setgadgetattribute.html">SetGadgetAttribute()</a>: Avec une des constantes suivantes:
    <font color="#924B72">#PB_ScrollArea_InnerWidth</font> : Modifie la largeur (en pixels) de la zone interne du gadget. 
    <font color="#924B72">#PB_ScrollArea_InnerHeight</font>: Modifie la hauteur (en pixels) de la zone interne du gadget.  

  - <a href="setgadgetcolor.html">SetGadgetColor()</a> et <a href="getgadgetcolor.html">GetGadgetColor()</a> avec la constante <font color="#924B72">#PB_Gadget_BackColor</font> comme 'TypeCouleur' 
    pour changer la couleur de fond de la fenêtre MDI.
</font></pre>

</blockquote><p><b>Exemple</b></p><blockquote>

<pre><font face="Courier New, Courier, mono" size="2">  <font color="#924B72">#FenetrePrincipale</font> = 0
  <font color="#924B72">#FenetreFille</font> = 1
  <b><font color="#006666">If</font></b> <font color="#006666">OpenWindow</font>(<font color="#924B72">#FenetrePrincipale</font>, 0, 0, 400, 300, &quot;MDIGadget&quot;, <font color="#924B72">#PB_Window_SystemMenu</font> | <font color="#924B72">#PB_Window_ScreenCentered</font> | <font color="#924B72">#PB_Window_SizeGadget</font> | <font color="#924B72">#PB_Window_MaximizeGadget</font>)
    <b><font color="#006666">If</font></b> <font color="#006666">CreateMenu</font>(<font color="#924B72">#FenetrePrincipale</font>,<font color="#006666"> WindowID</font>(<font color="#924B72">#FenetrePrincipale</font>))
<font color="#006666">      MenuTitle</font>(&quot;Index de menu 0&quot;)
<font color="#006666">      MenuTitle</font>(&quot;Menu des fenêtres filles&quot;)
<font color="#006666">        MenuItem</font>(0, &quot;Elément auto-créé&quot;)
<font color="#006666">        MenuItem</font>(1, &quot;Elément auto-créé&quot;)
        
<font color="#006666">      MDIGadget</font>(0, 0, 0, 0, 0, 1, 2, <font color="#924B72">#PB_MDI_AutoSize</font>)
<font color="#006666">        AddGadgetItem</font>(0, <font color="#924B72">#FenetreFille</font>, &quot;Fenêtre fille&quot;)
          <font color="#006666">; ajouter des gadgets ici...</font>
<font color="#006666">      UseGadgetList</font>(<font color="#006666">WindowID</font>(<font color="#924B72">#FenetrePrincipale</font>)) <font color="#006666">; renvoie à la liste de gadgets de la fenêtre principale</font>
    <b><font color="#006666">EndIf</font></b>
    <b><font color="#006666">Repeat</font></b> : <b><font color="#006666">Until</font></b> <font color="#006666">WaitWindowEvent</font>()=<font color="#924B72">#PB_Event_CloseWindow</font>
  <b><font color="#006666">EndIf</font></b>
</font></pre>
<p><img src="../HelpPictures/mdigadget.png"></p>

</Blockquote><p><b>OS Supportés </b><Blockquote>Windows</Blockquote></p><center><- <a href=listviewgadget.html>ListViewGadget()</a> - <a href=index.html>Gadget Index</a> - <a href=openglgadget.html>OpenGLGadget()</a> -><br><br>

</body></html>